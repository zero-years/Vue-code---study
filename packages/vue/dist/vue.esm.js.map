{
  "version": 3,
  "sources": ["../../shared/src/utils.ts", "../../reactivity/src/system.ts", "../../reactivity/src/effect.ts", "../../reactivity/src/dep.ts", "../../reactivity/src/baseHandlers.ts", "../../reactivity/src/reavtive.ts", "../../reactivity/src/ref.ts", "../../reactivity/src/computed.ts", "../../reactivity/src/watch.ts", "../../runtime-core/src/componentProps.ts", "../../runtime-core/src/scheduler.ts", "../../runtime-core/src/componentSlots.ts", "../../runtime-core/src/component.ts", "../../runtime-core/src/vnode.ts", "../../runtime-core/src/h.ts", "../../runtime-core/src/apiCreateApp.ts", "../../runtime-core/src/componentRenderUtils.ts", "../../runtime-core/src/apiLifecycle.ts", "../../runtime-core/src/renderTemplateRef.ts", "../../runtime-core/src/renderer.ts", "../../runtime-core/src/useTemplateRef.ts", "../../runtime-dom/src/nodeOps.ts", "../../runtime-dom/src/modules/patchClass.ts", "../../runtime-dom/src/modules/patchStyle.ts", "../../runtime-dom/src/modules/event.ts", "../../runtime-dom/src/modules/patcchAttr.ts", "../../runtime-dom/src/patchProp.ts", "../../runtime-dom/src/index.ts"],
  "sourcesContent": ["export function isObject(value) {\r\n  return typeof value == 'object' && value !== null\r\n}\r\n\r\n/**\r\n * \u5224\u65AD\u503C\u662F\u5426\u53D8\u5316\u3002\u662F\u4E3A true\r\n * @param newValue \u65B0\u503C\r\n * @param oldValue \u8001\u503C\r\n * @returns\r\n */\r\nexport function hasChanged(newValue, oldValue) {\r\n  return !Object.is(newValue, oldValue)\r\n}\r\n\r\n/**\r\n * \u5224\u65AD\u503C\u662F\u5426\u4E3A\u51FD\u6570\uFF0C\u662F\u4E3A true\r\n */\r\nexport function isFunction(value) {\r\n  return typeof value === 'function'\r\n}\r\n\r\n/**\r\n * \u5224\u65AD\u503C\u662F\u5426\u4E3A string\r\n * @param value\r\n * @returns\r\n */\r\nexport function isString(value) {\r\n  return typeof value === 'string'\r\n}\r\n\r\n/**\r\n *  \u5224\u65AD\u662F\u5426\u4E3A\u4E8B\u4EF6\r\n *  \u4E8B\u4EF6\u5728 vue \u7684\u5F00\u5934\u90FD\u662F onXxx ==> onClick \uFF0C\u56E0\u6B64\u901A\u8FC7\u6B63\u5219\u53BB\u63D0\u53D6\u524D\u4E09\u4F4D\uFF0C\u7136\u540E\u901A\u8FC7 test \u65B9\u6CD5\u53BB\u68C0\u7D22 key \u4E2D\u662F\u5426\u5B58\u5728\uFF0C\u5B58\u5728\u5219\u8FD4\u56DE true\r\n *\r\n * @param key\r\n * @returns\r\n */\r\nexport function isOn(key) {\r\n  return /^on[A-Z]/.test(key)\r\n}\r\n\r\n/**\r\n * \u5224\u65AD\u662F\u5426\u4E3A\u6570\u5B57\r\n * @param value\r\n * @returns\r\n */\r\nexport function isNumber(value) {\r\n  return typeof value === 'number'\r\n}\r\n\r\n// \u5224\u65AD\u662F\u5426\u4E3A\u6570\u7EC4\r\nexport const isArray = Array.isArray\r\n\r\n/**\r\n * \u5224\u65AD\u5F53\u524D\u5BF9\u8C61\u4E2D\u662F\u5426\u5B58\u5728 key \u76F8\u5173\u7684\u5C5E\u6027\r\n * @param object\r\n * @param key\r\n * @returns\r\n */\r\nexport function hasOwn(object = {}, key) {\r\n  return Object.hasOwn(object, key)\r\n}\r\n", "// \u4F9D\u8D56\u9879\r\nexport interface Dependency {\r\n  // \u8BA2\u9605\u8005\u94FE\u8868\u7684\u5934\u8282\u70B9\r\n  subs: Link | undefined\r\n  // \u8BA2\u9605\u8005\u94FE\u8868\u7684\u5C3E\u8282\u70B9\r\n  subsTail: Link | undefined\r\n}\r\n\r\n// Sub \u8BA2\u9605\u8005\r\nexport interface Sub {\r\n  // \u8BA2\u9605\u8005\u94FE\u8868\u7684\u5934\u8282\u70B9\r\n  deps: Link | undefined\r\n  // \u8BA2\u9605\u8005\u94FE\u8868\u7684\u5C3E\u8282\u70B9\r\n  depsTail: Link | undefined\r\n  // tracking \u7528\u4E8E\u5224\u65AD\u662F\u5426\u5DF2\u7ECF\u8FFD\u8E2A\r\n  tracking: boolean\r\n}\r\n\r\n/**\r\n * \u94FE\u8868\u8282\u70B9 \u7528\u6765\u50A8\u5B58 effect \u51FD\u6570\r\n */\r\nexport interface Link {\r\n  // effect \u51FD\u6570\r\n  sub: Sub\r\n  // \u4E0B\u4E00\u4E2A\u8BA2\u9605\u8005\u8282\u70B9\r\n  nextSub: Link | undefined\r\n  // \u4E0A\u4E00\u4E2A\u8BA2\u9605\u8005\u8282\u70B9\r\n  prevSub: Link | undefined\r\n\r\n  // \u4F9D\u8D56\u9879\r\n  dep: Dependency\r\n  // \u4E0B\u4E00\u4E2A\u4F9D\u8D56\u9879\r\n  nextDep: Link | undefined\r\n}\r\n\r\n// \u4FDD\u5B58\u4E00\u4E2A\u5DF2\u7ECF\u521B\u5EFA\u8FC7\u4F46\u88AB\u6E05\u9664\u7684\u8282\u70B9\r\nlet linkPool: Link\r\n\r\n/**\r\n * \u94FE\u63A5\u94FE\u8868\u5173\u7CFB\uFF0C \u6536\u96C6\u4F9D\u8D56\r\n * @param dep\r\n * @param sub \u8BA2\u9605\u8005\uFF0C\u4F9D\u8D56\u53D8\u5316\u65F6\u9700\u8981\u901A\u77E5\u7684 effect \u51FD\u6570\uFF0C\u4ECE\u800C\u91CD\u65B0\u6267\u884C\r\n */\r\nexport function link(dep, sub) {\r\n  // region \u5C1D\u8BD5\u590D\u7528\u94FE\u8868\u8282\u70B9\r\n  const currentDep = sub.depsTail\r\n\r\n  /**\r\n   * \u5206\u4E24\u79CD\u60C5\u51B5\r\n   * P1: \u5934\u8282\u70B9\u5B58\u5728\uFF0C\u5C3E\u8282\u70B9\u4E3A undefined \uFF0C \u590D\u7528\u5934\u8282\u70B9\r\n   * P2: \u5C3E\u8282\u70B9\u5B58\u5728 nextDep \uFF0C\u590D\u7528\u5C3E\u8282\u70B9\u7684\u4E0B\u4E00\u4E2A\u8282\u70B9 nextDep\r\n   */\r\n  const nextDep = currentDep === undefined ? sub.deps : currentDep.nextDep\r\n\r\n  if (nextDep && nextDep.dep === dep) {\r\n    sub.depsTail = nextDep\r\n    return\r\n  }\r\n  // endregion\r\n\r\n  // \u5982\u679C\u5B58\u5728 activeSub \uFF0C\u5C31\u4FDD\u5B58\u8D77\u6765\uFF0C\u7B49 set(\u66F4\u65B0\u65F6)\u89E6\u53D1\r\n  let newLink: Link | undefined\r\n\r\n  /**\r\n   * \u67E5\u770B\u662F\u5426\u5177\u6709 linkPool \uFF0C\u5982\u679C\u5177\u6709 linkPool \uFF0C\u5219\u8BC1\u660E\u4E4B\u524D\u5177\u6709\u53EF\u4EE5\u590D\u7528\u7684\u8282\u70B9\uFF0C\u5C31\u590D\u7528\u4E4B\u524D\u7684\u8282\u70B9\uFF0C\u6CA1\u6709\u5C31\u521B\u5EFA\u65B0\u7684\u8282\u70B9\r\n   */\r\n  if (linkPool) {\r\n    newLink = linkPool\r\n    linkPool = linkPool.nextDep\r\n    newLink.nextDep = nextDep\r\n    newLink.dep = dep\r\n    newLink.sub = sub\r\n  } else {\r\n    newLink = {\r\n      dep,\r\n      nextDep,\r\n      sub,\r\n      nextSub: undefined,\r\n      prevSub: undefined,\r\n    }\r\n  }\r\n\r\n  // region \u5C06\u94FE\u8868\u8282\u70B9\u548C  dep \u5EFA\u7ACB\u5173\u8054\u5173\u7CFB\r\n  // \u5B9E\u73B0\u903B\u8F91\r\n  /**\r\n   * \u5173\u8054\u53CC\u5411\u94FE\u8868\u5173\u7CFB\uFF0C\u5206\u4E24\u79CD\u60C5\u51B5\r\n   * 1. \u5B58\u5728\u5C3E\u8282\u70B9\uFF0C\u5F80\u5C3E\u8282\u70B9\u540E\u9762\u52A0\r\n   * 2. \u4E0D\u5B58\u5728\u4E3A\u8282\u70B9\uFF0C\u5219\u8868\u793A\u7B2C\u4E00\u6B21\u5173\u8054\uFF0C\u5219\u5F80\u5934\u8282\u70B9\u52A0\uFF0C\u5E76\u4E14\u5934\u5C3E\u8282\u70B9\u76F8\u540C\r\n   */\r\n  if (dep.subsTail) {\r\n    dep.subsTail.nextSub = newLink\r\n    newLink.prevSub = dep.subsTail\r\n    dep.subsTail = newLink\r\n  } else {\r\n    dep.subs = newLink\r\n    dep.subsTail = newLink\r\n  }\r\n  // endregion\r\n\r\n  // region \u5C06\u5217\u8868\u8282\u70B9\u4E0E sub \u5EFA\u7ACB\u5173\u7CFB\uFF0C\u662F\u5355\u5411\u94FE\u8868\r\n  // \u5B9E\u73B0\u903B\u8F91\r\n  /**\r\n   * \u5173\u8054\u53CC\u5411\u94FE\u8868\u5173\u7CFB\uFF0C\u5206\u4E24\u79CD\u60C5\u51B5\r\n   * 1. \u5B58\u5728\u5C3E\u8282\u70B9\uFF0C\u5F80\u5C3E\u8282\u70B9\u540E\u9762\u52A0\r\n   * 2. \u4E0D\u5B58\u5728\u4E3A\u8282\u70B9\uFF0C\u5219\u8868\u793A\u7B2C\u4E00\u6B21\u5173\u8054\uFF0C\u5219\u5F80\u5934\u8282\u70B9\u52A0\uFF0C\u5E76\u4E14\u5934\u5C3E\u8282\u70B9\u76F8\u540C\r\n   */\r\n  if (sub.depsTail) {\r\n    sub.depsTail.nextDep = newLink\r\n    sub.depsTail = newLink\r\n  } else {\r\n    sub.deps = newLink\r\n    sub.depsTail = newLink\r\n  }\r\n\r\n  // endregion\r\n}\r\n\r\n/**\r\n * \u66F4\u65B0\u6240\u6709\u5173\u8054 effect \u7684\u51FD\u6570(\u4F20\u64AD\u66F4\u65B0\u51FD\u6570)\r\n * @param subs \u4F20\u5165\u4E00\u4E2A\u5934\u90E8\u8282\u70B9\uFF0C\u7136\u540E\u4F9D\u6B21\u89E6\u53D1\u4E0B\u53BB\r\n */\r\nexport function propagate(subs) {\r\n  // \u901A\u77E5 effect \u6267\u884C\uFF0C\u4ECE\u800C\u83B7\u53D6\u6700\u65B0\u7684\u503C\r\n  let link = subs\r\n  let queuedEffect = []\r\n  while (link) {\r\n    const sub = link.sub\r\n    if (!sub.tracking && !sub.dirty) {\r\n      //\u8BA1\u7B97\u5C5E\u6027\u6807\u8BB0\u4E3A\u810F\r\n      sub.dirty = true\r\n      if ('update' in sub) {\r\n        processComputedUpdate(sub)\r\n      } else {\r\n        queuedEffect.push(link.sub)\r\n      }\r\n    }\r\n    link = link.nextSub\r\n  }\r\n  queuedEffect.forEach(effect => effect.notify())\r\n}\r\n\r\n/**\r\n * \u5F00\u59CB\u8FFD\u8E2A\u4F9D\u8D56\uFF0C\u5C06 depsTail \u5C3E\u8282\u70B9\u8BBE\u7F6E\u4E3A undefined\r\n * @param sub \u5F53\u524D effect \u51FD\u6570\u7684 this\r\n */\r\nexport function startTrack(sub) {\r\n  sub.tracking = true\r\n  sub.depsTail = undefined\r\n}\r\n\r\n/**\r\n * \u7ED3\u675F\u8FFD\u8E2A\uFF0C\u627E\u5230\u9700\u8981\u6E05\u7406\u7684\u4F9D\u8D56\uFF0C\u901A\u8FC7\u8C03\u7528 clearTracking \u8FDB\u884C\u4F9D\u8D56\u6E05\u7406\uFF0C\u65AD\u5F00\u5173\u8054\u5173\u7CFB\r\n * @param this \u5F53\u524D effect \u51FD\u6570\u7684 this\r\n */\r\nexport function endTrack(sub) {\r\n  sub.tracking = false\r\n  const depsTail = sub.depsTail\r\n\r\n  // \u8FFD\u8E2A\u5B8C\u4E86\uFF0C\u4E0D\u810F\u4E86\r\n  sub.dirty = false\r\n  /**\r\n   * \u9700\u8981\u6E05\u9664\u7684\u51E0\u79CD\u60C5\u51B5\r\n   * - 1. depsTail \u6709\uFF0C\u540C\u65F6 depsTail \u5185\u6709 nextDep \uFF0C\u9700\u8981\u5C06\u4F9D\u8D56\u6E05\u9664\r\n   * - 2. depsTail \u6CA1\u6709\uFF0C\u5E76\u4E14\u5934\u8282\u70B9\u6709\uFF0C\u5219\u628A\u6240\u6709\u4F9D\u8D56\u6E05\u9664\r\n   */\r\n  if (depsTail) {\r\n    if (depsTail.nextDep) {\r\n      clearTracking(depsTail.nextDep)\r\n      depsTail.nextDep = undefined\r\n    }\r\n  } else if (sub.deps) {\r\n    clearTracking(sub.deps)\r\n    sub.deps = undefined\r\n  }\r\n}\r\n\r\n/**\r\n * \u6E05\u7406\u65E0\u5173\u4F9D\u8D56\u7684\u51FD\u6570\r\n * @param link \u9700\u8981\u6E05\u7406\u7684\u4F9D\u8D56\u9879\u8282\u70B9\r\n */\r\nfunction clearTracking(link: Link) {\r\n  while (link) {\r\n    const { prevSub, nextSub, dep, nextDep } = link\r\n\r\n    // 1. \u5982\u679C\u4E0A\u4E00\u4E2A\u8282\u70B9(prevSub) \u6709\uFF0C\u90A3\u5C31\u628A prevSub \u7684 nextSub \u8BBE\u7F6E\u4E3A\u5F53\u524D\u8282\u70B9\u7684 nextSub\r\n    // 2. \u5982\u679C\u4E0A\u4E00\u4E2A\u8282\u70B9(prevSub) \u6CA1\u6709, \u8BC1\u660E\u662F\u5934\u8282\u70B9\uFF0C\u5C31\u628A dep \u4E2D\u7684 subs \u53D8\u4E3A\u5F53\u524D\u7684 nextSub\uFF0C\u7136\u540E\u628A nextSub \u7684 prevSub \u8BBE\u7F6E\u4E3A\u7A7A\r\n    // 3. \u5982\u679C\u4E0B\u4E00\u4E2A\u8282\u70B9(nextSub) \u6709\uFF0C\u90A3\u5C31\u628A  nextSub \u7684 prevSub  \u8BBE\u7F6E\u4E3A\u5F53\u524D\u8282\u70B9\u7684 prevSub\r\n    // 4. \u5982\u679C\u4E0B\u4E00\u4E2A\u8282\u70B9(nextSub) \u6CA1\u6709, \u8BC1\u660E\u662F\u5C3E\u8282\u70B9\uFF0C\u5C31\u628A dep \u4E2D\u7684 subsTail \u8BBE\u7F6E\u4E3A\u5F53\u524D\u8282\u70B9\u7684 prevSub, \u7136\u540E\u628A prevSub \u8BBE\u7F6E\u4E3A\u7A7A\r\n\r\n    // \u5224\u65AD\u4E0A\u4E00\u4E2A\u8282\u70B9\r\n    if (prevSub) {\r\n      prevSub.nextSub = nextSub\r\n      link.nextSub = undefined\r\n    } else {\r\n      dep.subs = nextSub\r\n    }\r\n\r\n    // \u5224\u65AD\u4E0B\u4E00\u4E2A\u8282\u70B9\r\n    if (nextSub) {\r\n      nextSub.prevSub = prevSub\r\n      link.prevSub = undefined\r\n    } else {\r\n      dep.subsTail = prevSub\r\n    }\r\n\r\n    link.dep = link.sub = undefined\r\n\r\n    // \u628A\u4E0D\u8981\u7684\u8282\u70B9\u7ED9 linkPool \uFF0C\u8BA9\u5B83\u80FD\u591F\u590D\u7528\r\n    link.nextDep = linkPool\r\n    linkPool = link\r\n\r\n    link = nextDep\r\n  }\r\n}\r\n\r\n/**\r\n * \u7528\u6765\u5904\u7406\u5F53\u89E6\u53D1\u66F4\u65B0\u65F6\uFF0C\u5F53\u524D\u51FD\u6570\u4E3A computed \u51FD\u6570\u9047\u5230\u7684\u95EE\u9898\r\n * @param sub \u5904\u7406\u89E6\u53D1\u66F4\u65B0\u65F6\u4E3A computed \u7684\u89E6\u53D1\u51FD\u6570\r\n */\r\nfunction processComputedUpdate(sub) {\r\n  /**\r\n   * \u66F4\u65B0\u8BA1\u7B97\u5C5E\u6027\r\n   *  - 1. \u8C03\u7528 update\r\n   *  - 2. \u901A\u77E5 subs \u94FE\u8868\u4E0A\u6240\u6709\u7684 sub \u91CD\u65B0\u6267\u884C\r\n   */\r\n  if (sub.subs && sub.update()) {\r\n    // sub.update() \u4F1A\u8FD4\u56DE\u4E00\u4E2A\u503C\uFF0C\u4F46\u503C\u4E3A true \u5219\u8868\u793A\u5F53\u524D\u503C\u53D1\u751F\u53D8\u5316\r\n    propagate(sub.subs)\r\n  }\r\n}\r\n", "import { Link, startTrack, endTrack, Sub } from './system'\r\n// \u7528\u6765\u4FDD\u5B58\u5F53\u524D\u6267\u884C\u7684 effect\r\nexport let activeSub\r\n\r\nexport function setActiveSub(sub) {\r\n  activeSub = sub\r\n}\r\n\r\nexport class ReactiveEffect implements Sub {\r\n  // \u4F9D\u8D56\u94FE\u8868\u7684\u5934\u8282\u70B9\r\n  deps: Link | undefined\r\n\r\n  // \u4F9D\u8D56\u94FE\u8868\u7684\u5C3E\u8282\u70B9\r\n  depsTail: Link | undefined\r\n\r\n  // tracking \u7528\u4E8E\u5224\u65AD\u662F\u5426\u5DF2\u7ECF\u8FFD\u8E2A\r\n  tracking = false\r\n\r\n  // \u5904\u7406\u4E00\u4E2A effect \u5185\u5BF9\u540C\u4E2A ref \u8FDB\u884C\u591A\u6B21\u6536\u96C6\u7684\u903B\u8F91\r\n  // - Vue \u6E90\u7801\u91C7\u53D6\u904D\u5386\u7684\u65B9\u6CD5\uFF0C\u67E5\u770B dep \u94FE\u6761\u4E2D\u662F\u5426\u5B58\u5728 sub\r\n  // - \u672C\u5185\u5BB9\u91C7\u53D6\u7A7A\u95F4\u6362\u65F6\u95F4\u7684\u65B9\u6CD5\uFF0C\u901A\u8FC7\u4E00\u4E2A dirty \u786E\u5B9A\u662F\u5426\u9700\u8981\u6536\u96C6\r\n  dirty = false\r\n\r\n  constructor(public fn) {}\r\n\r\n  /**\r\n   * \u7528\u6765\u6267\u884C\u54CD\u5E94\u5F0F\u65B9\u6CD5\r\n   * @returns \u6267\u884C\u5F53\u524D\u7684 \u54CD\u5E94\u5F0F\u65B9\u6CD5\r\n   */\r\n  run() {\r\n    if (!this.active) {\r\n      return this.fn()\r\n    }\r\n    // \u5148\u5C06\u5F53\u524D\u7684  effect \u4FDD\u5B58\u8D77\u6765\uFF0C\u4ECE\u800C\u5904\u7406\u5D4C\u5957\u7684\u903B\u8F91\u3002\u5B58\u5728 effect \u5219\u4FDD\u5B58\uFF0C\u4E0D\u5B58\u5728\u5219\u4E3A undefined\r\n    const prevSub = activeSub\r\n\r\n    // \u6BCF\u6B21\u6267\u884C fn \u4E4B\u524D\u628A this \u5B58\u50A8\u5230 activeSub \u4E2D\uFF0C \u8FD9\u6837\u80FD\u591F\u4F7F\u540C\u4E00\u4E2A effect \u5185\u7684\u4F9D\u8D56\u6536\u96C6\u51FD\u6570\u4E2D\u7684 activeSub(sub) \u4E3A\u540C\u4E00\u4E2A\uFF0C\u4F7F\u5F97\u4ED6\u4EEC\u7684 deps \u548C depsTail \u80FD\u591F\u4E3A\u540C\u4E00\u4E2A\r\n    setActiveSub(this)\r\n    // \u6BCF\u6B21\u91CD\u65B0\u6267\u884C effect \u65F6\u9700\u8981\u5C06 depsTail \u8BBE\u7F6E\u4E3A undefined \u4ECE\u800C\u4F7F\u5F97 effect \u4F1A\u4ECE\u5934\u8282\u70B9\u5F00\u59CB\u6267\u884C\u51FD\u6570\r\n    startTrack(this)\r\n\r\n    try {\r\n      return this.fn()\r\n    } finally {\r\n      // \u6267\u884C\u5B8C\u6210\u540E\uFF0C\u9700\u8981\u5224\u65AD\u5F53\u524D depsTail \u662F\u5426\u5177\u6709 nextDep \uFF0C\u8FD9\u4E9B nextDep \u90FD\u662F\u9700\u8981\u6E05\u7406\u7684\u5185\u5BB9\uFF0C\u56E0\u4E3A\u4ED6\u5DF2\u7ECF\u4E0D\u6EE1\u8DB3\u65B0\u7684 effect \u51FD\u6570\r\n      endTrack(this)\r\n\r\n      // \u6267\u884C\u5B8C\u6210\u540E \u628A  activeSub \u6062\u590D\u4E3A\u4E4B\u524D\u7684 effects\r\n      setActiveSub(prevSub)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * \u901A\u77E5\u66F4\u65B0\uFF0C\u5982\u679C\u4F9D\u8D56\u7684\u6570\u636E\u53D1\u751F\u4E86\u53D8\u5316\uFF0C\u4F1A\u8C03\u7528\u8FD9\u4E2A\u51FD\u6570\r\n   */\r\n  notify() {\r\n    this.scheduler()\r\n  }\r\n\r\n  /**\r\n   * \u9ED8\u8BA4\u8C03\u7528 run \uFF0C\u5982\u679C\u7528\u6237\u4F20\u4E86 scheduler \u5219\u8C03\u7528\u7528\u6237\u4F20\u5165\u7684 scheduler \u65B9\u6CD5\uFF0C \u7C7B\u4F3C\u539F\u578B\u65B9\u6CD5\u4E0E\u5B9E\u4F8B\u65B9\u6CD5\r\n   */\r\n  scheduler() {\r\n    this.run()\r\n  }\r\n\r\n  // effect \u6FC0\u6D3B\u6807\u8BB0\uFF0C\u9ED8\u8BA4\u4E3A true\r\n  active = true\r\n\r\n  stop() {\r\n    if (this.active) {\r\n      // \u6E05\u7406\u4F9D\u8D56\r\n      startTrack(this)\r\n\r\n      endTrack(this)\r\n\r\n      // \u5C06 effct \u7684\u6FC0\u6D3B\u6807\u8BB0\u5173\u95ED\r\n      this.active = false\r\n    }\r\n  }\r\n}\r\n\r\nexport function effect(fn, options) {\r\n  const e = new ReactiveEffect(fn)\r\n\r\n  // scheduler \u89E6\u53D1\u66F4\u65B0\u7684\u914D\u7F6E\r\n  Object.assign(e, options)\r\n\r\n  e.run()\r\n\r\n  /**\r\n   * \u7ED1\u5B9A\u51FD\u6570\u7684 this\r\n   * P1: e.run.bind(e)\r\n   * P2: () => e.run()\r\n   */\r\n  const runner = e.run.bind(e)\r\n\r\n  // \u628A effect \u5B9E\u4F8B\u653E\u5230\u51FD\u6570\u91CC\uFF0C\u7136\u540E\u8FD4\u56DE\u7ED9\u5916\u90E8\r\n  runner.effect = e\r\n\r\n  return runner\r\n}\r\n", "import { type Link, link, propagate } from './system'\r\nimport { activeSub } from './effect'\r\n\r\nconst targetMap = new WeakMap()\r\n\r\nexport function track(target, key) {\r\n  if (!activeSub) {\r\n    return\r\n  }\r\n\r\n  /**\u627E depsMap \uFF0C\u627E\u5230\u5F53\u524D\u7684 target \u5BF9\u5E94\u7684 map\r\n   *\r\n   * depsMap = {\r\n   *    a: Dep,\r\n   *    b: Dep\r\n   * }\r\n   * */\r\n  let depsMap = targetMap.get(target)\r\n\r\n  if (!depsMap) {\r\n    // \u6CA1\u6709 depsMap , \u610F\u5473\u7740\u4E4B\u524D\u6CA1\u6709\u6536\u96C6\u8FC7\u8FD9\u4E2A target \u5BF9\u8C61\u91CC\u7684\u4EFB\u4F55 key\uFF0C\u56E0\u6B64\u9700\u8981\u521B\u5EFA\u4E00\u4E2A\u65B0\u7684 map\uFF0C\u6765\u4FDD\u5B58 target \u548C depsMap \u4E4B\u95F4\u7684\u5173\u8054\u5173\u7CFB\r\n    depsMap = new Map()\r\n    targetMap.set(target, depsMap)\r\n  }\r\n\r\n  // \u627E\u5230 key \u76F8\u5173\u8054\u7684 dep\r\n  let dep = depsMap.get(key)\r\n\r\n  if (!dep) {\r\n    // \u7B2C\u4E00\u6B21\u6536\u96C6\u8FD9\u4E2A\u5BF9\u8C61\uFF0C\u5219\u9700\u8981\u521B\u5EFA\u4E00\u4E2A dep \u91CC\u9762\u6709 subs \u548C subsTail\uFF0C\u7136\u540E\u4FDD\u5B58\u5230 depsMap \u4E2D\r\n    dep = new Dep()\r\n    depsMap.set(key, dep)\r\n  }\r\n\r\n  // \u7ED1\u5B9A dep \u548C activeSub \u7684\u5173\u7CFB\r\n  link(dep, activeSub)\r\n}\r\n\r\nexport function trigger(target, key) {\r\n  const depsMap = targetMap.get(target)\r\n\r\n  /**\u627E depsMap \uFF0C\u627E\u5230\u5F53\u524D\u7684 target \u5BF9\u5E94\u7684 map\r\n   *\r\n   * depsMap = {\r\n   *    a: Dep,\r\n   *    b: Dep\r\n   * }\r\n   * */\r\n  if (!depsMap) {\r\n    // depsMap \u6CA1\u6709\uFF0C\u8868\u793A\u8FD9\u4E2A\u5BF9\u8C61\u6CA1\u6709\u4EFB\u4F55\u5C5E\u6027\u5728 sub \u4E2D\u8BBF\u95EE\uFF0C\u610F\u5473\u7740\u4E0D\u9700\u8981\u8FDB\u884C\u66F4\u65B0\r\n    return\r\n  }\r\n\r\n  const targetIsArray = Array.isArray(target)\r\n\r\n  if (targetIsArray && key === 'length') {\r\n    /**\u66F4\u65B0\u6570\u7EC4\u7684 length\r\n     * \u66F4\u65B0\u524D state.length = 4 ==> ['a', 'b', 'c', 'd']\r\n     * \u66F4\u65B0\u540E state.length = 2 ==> ['a', 'b']\r\n     * \u6B64\u65F6\u9700\u8981\u901A\u77E5\u7ED1\u5B9A\u4E86 c \u548C d \u7684 effect \u91CD\u65B0\u6267\u884C\uFF0C\u4E5F\u5C31\u662F\u90A3\u4E9B\u7D22\u5F15\u5927\u4E8E\u7B49\u4E8E length \u7684\u5185\u5BB9\r\n     *\r\n     * depsMap = {\r\n     *  0: dep,\r\n     *  1: dep,\r\n     *  2: dep,\r\n     *  3: dep,\r\n     *  length: dep\r\n     * }\r\n     */\r\n    const length = target.length\r\n    depsMap.forEach((dep, depKey) => {\r\n      if (depKey >= length || depKey === 'length') {\r\n        // \u901A\u77E5\u8BBF\u95EE\u4E86\u5927\u4E8E\u7B49\u4E8E length \u7684 subs \u91CD\u65B0\u6267\u884C\u6536\u96C6\uFF0C\u4ECE\u800C\u6E05\u7A7A\u4F9D\u8D56\r\n        // \u5F53\u8BBF\u95EE\u7684\u662F length \u4E5F\u9700\u8981\u5C06 length \u76F8\u5173\u7684 sub \u91CD\u65B0\u6267\u884C\r\n        propagate(dep.subs)\r\n      }\r\n    })\r\n  } else {\r\n    // \u4E0D\u662F\u6570\u7EC4\uFF0C\u6216\u8005\u6570\u7EC4\u66F4\u65B0\u7684\u4E0D\u662F length\uFF0C\u5219\u76F4\u63A5\u6267\u884C\u4EE5\u4E0B\u5185\u5BB9\r\n\r\n    // \u627E\u5230 key \u76F8\u5173\u8054\u7684 dep\r\n    const dep = depsMap.get(key)\r\n\r\n    if (!dep) {\r\n      // dep \u6CA1\u6709\uFF0C\u8868\u793A\u8FD9\u4E2A key \u6CA1\u6709\u5728 sub \u4E2D\u8BBF\u95EE\u3002\u5219\u76F4\u63A5 return \uFF0C\u4E0D\u9700\u8981\u89E6\u53D1\u66F4\u65B0\r\n      return\r\n    }\r\n\r\n    // \u627E\u5230 dep.subs \u901A\u77E5\u4ED6\u4EEC\u91CD\u65B0\u6267\u884C\r\n    propagate(dep.subs)\r\n  }\r\n}\r\n\r\nclass Dep {\r\n  // \u8BA2\u9605\u8005\u94FE\u8868\u7684\u5934\u8282\u70B9\uFF0C\u7406\u89E3\u4E3A\u94FE\u8868\u4E2D\u7684 head\r\n  subs: Link\r\n\r\n  // \u8BA2\u9605\u8005\u94FE\u8868\u7684\u5C3E\u8282\u70B9\uFF0C\u7406\u89E3\u4E3A\u94FE\u8868\u4E2D\u7684 tail\r\n  subsTail: Link\r\n}\r\n", "import { track, trigger } from './dep'\r\nimport { isRef } from './ref'\r\nimport { hasChanged, isObject } from 'packages/shared/src/utils'\r\nimport { reactive } from './reavtive'\r\n\r\nexport const mutableHandlers = {\r\n  /**\r\n   * \u6536\u96C6\u4F9D\u8D56\uFF0C \u7ED1\u5B9A target \u4E2D\u7684\u67D0\u4E00\u4E2A key \u548C sub \u4E4B\u95F4\u7684\u5173\u7CFB\r\n   *\r\n   * @param target target = {a:0}\r\n   * @param key  target \u4E2D\u5BF9\u5E94\u7684 key\u503C a\r\n   * @param receiver\r\n   * @returns\r\n   */\r\n  get(target, key, receiver) {\r\n    track(target, key)\r\n\r\n    const res = Reflect.get(target, key, receiver)\r\n\r\n    if (isRef(res)) {\r\n      // \u5982\u679C target \u662F\u4E00\u4E2A ref \uFF0C\u5C31\u76F4\u63A5\u628A\u503C\u7ED9\u5B83\uFF0C\u4E0D\u8981\u5728\u7EE7\u7EED .value\r\n      // target = { a: ref(0)}\r\n      return res.value\r\n    }\r\n\r\n    if (isObject(res)) {\r\n      // \u5982\u679C res \u662F\u4E00\u4E2A\u5BF9\u8C61\u5219\u7EE7\u7EED\u5305\u88C5\u6210 reactive\r\n      return reactive(res)\r\n    }\r\n\r\n    // receiver \u7528\u6765\u4FDD\u8BC1\u8BBF\u95EE\u5668\u91CC\u9762\u7684 this \u6267\u884C\u4EE3\u7406\u5BF9\u8C61 proxy\r\n    return res\r\n  },\r\n\r\n  /**\r\n   * \u89E6\u53D1\u66F4\u65B0, set \u7684\u65F6\u5019\uFF0C\u901A\u77E5\u5DF2\u7ECF\u6536\u96C6\u5B8C\u7684\u76F8\u5BF9\u5E94\u7684\u4F9D\u8D56\u91CD\u65B0\u6267\u884C\r\n   *\r\n   * @param target \u5BF9\u8C61 target = { a: 0}\r\n   * @param key \u952E\u540D a\r\n   * @param newValue \u4FEE\u6539\u7684\u503C\r\n   * @param receiver\r\n   */\r\n  set(target, key, newValue, receiver) {\r\n    // \u62FF\u5230\u66F4\u65B0\u524D\u7684\u503C\r\n    const oldValue = target[key]\r\n\r\n    //\u62FF\u5230\u66F4\u65B0\u7684 length\r\n    const targetIsArray = Array.isArray(target)\r\n    const oldLength = targetIsArray ? target.length : 0\r\n\r\n    // \u5982\u679C\u66F4\u65B0 reactive \u91CC\u9762 a \u7684\u503C\u4E4B\u524D\u662F\u4E2A ref \uFF0C\u4E14\u65B0\u7684 ref \u4E0D\u662F\u4E00\u4E2A ref \u3002\u5219\u9700\u8981\u540C\u6B65\u4FEE\u6539 \u59CB a \u7684 ref \u7684\u503C\u4E3A newValue\r\n    // \u5982\u679C\u66F4\u65B0\u7684 newValue \u662F\u4E00\u4E2A ref \uFF0C\u90A3\u5C31\u4E0D\u9700\u8981\u540C\u6B65\u66F4\u65B0\r\n    if (isRef(oldValue) && !isRef(newValue)) {\r\n      /**\r\n       * const a = ref(0)\r\n       * target = { a}\r\n       *\r\n       * target.a = 1 \u5C31\u53EF\u4EE5\u770B\u4F5C a.value = 1\r\n       * a.value = 1\r\n       */\r\n      oldValue.value = newValue\r\n      return true\r\n    }\r\n\r\n    // \u5148\u901A\u77E5 set \u5728 \u89E6\u53D1\u66F4\u65B0\r\n    const res = Reflect.set(target, key, newValue, receiver)\r\n\r\n    // \u5224\u65AD\u66F4\u6539\u524D\u540E\u7684\u503C\u662F\u5426\u76F8\u540C\uFF0C\u76F8\u540C\u5219\u4E0D\u5904\u7406\uFF0C\u4E0D\u76F8\u540C\u5219\u89E6\u53D1\u66F4\u65B0\r\n    if (hasChanged(newValue, oldValue)) {\r\n      trigger(target, key)\r\n    }\r\n\r\n    // \u62FF\u5230\u66F4\u65B0\u540E\u7684\u503C\r\n    const newLength = targetIsArray ? target.length : 0\r\n\r\n    //  \u5904\u7406\u9690\u5F0F\u66F4\u65B0\u6570\u7EC4\u7684 length\r\n    if (targetIsArray && newLength !== oldLength && key !== 'length') {\r\n      /**\r\n       * \u9690\u5F0F\u66F4\u65B0 length \uFF0C\u4F8B\u5982 push\u3001 pop\u7B49\r\n       * \u66F4\u65B0\u524D state.length = 4 ==> ['a', 'b', 'c', 'd']\r\n       * \u66F4\u65B0\u540E state.length = 5 ==> ['a', 'b', 'c', 'd', 'e']\r\n       * \u66F4\u65B0\u52A8\u4F5C\uFF0C\u4EE5 push \u4E3A\u4F8B\uFF0C\u8FFD\u52A0\u4E86\u4E00\u4E2A e\r\n       * \u9690\u5F0F\u66F4\u65B0\u7684\u65B9\u6CD5: push pop shift unshift\r\n       * \u901A\u8FC7\u5BF9\u6BD4\u4E00\u4E2A\u66F4\u65B0\u524D\u4E0E\u4E00\u4E2A\u66F4\u65B0\u540E\u7684 length \u6765\u5224\u65AD\u662F\u5426\u6709\u9690\u5F0F\u66F4\u65B0\r\n       * */\r\n      trigger(target, 'length')\r\n    }\r\n\r\n    return res\r\n  },\r\n}\r\n", "import { isObject } from 'packages/shared/src/utils'\r\nimport { mutableHandlers } from './baseHandlers'\r\n\r\nexport function reactive(target) {\r\n  return createReactiveObject(target)\r\n}\r\n\r\n/** \u4FDD\u5B58 target \u548C \u54CD\u5E94\u5F0F\u5BF9\u8C61\u4E4B\u95F4\u7684\u5173\u8054\u5173\u7CFB\uFF0C\u4ECE\u800C\u9632\u6B62\u540C\u4E00\u4E2A\u4EE3\u7406\u5BF9\u8C61\u88AB\u591A\u6B21\u521B\u5EFA\r\n *\r\n *  target => proxy\r\n * */\r\nconst reactiveMap = new WeakMap()\r\n\r\n/**\r\n * \u4FDD\u5B58\u6240\u6709\u4F7F\u7528 reactive \u521B\u5EFA\u51FA\u6765\u7684\u54CD\u5E94\u5F0F\u5BF9\u8C61\r\n */\r\nconst reactiveSet = new WeakSet()\r\n\r\nexport function createReactiveObject(target) {\r\n  // reactive \u5FC5\u987B\u8981\u63A5\u53D7\u4E00\u4E2A\u5BF9\u8C61\r\n  if (!isObject(target)) {\r\n    // target \u4E0D\u662F\u4E00\u4E2A\u5BF9\u8C61\uFF0C\u5219\u8FD4\u56DE\u53BB\r\n    return target\r\n  }\r\n\r\n  // \u5224\u65AD\u5F53\u524D target \u662F\u5426\u5DF2\u7ECF\u662F\u54CD\u5E94\u5F0F\u5BF9\u8C61\r\n  if (reactiveSet.has(target)) {\r\n    return target\r\n  }\r\n\r\n  // \u67E5\u770B\u4E4B\u524D\u8FD9\u4E2A target \u662F\u5426\u6709\u4EE3\u7406\u5BF9\u8C61\r\n  const exisitingProxy = reactiveMap.get(target)\r\n\r\n  // \u5982\u679C\u8FD9\u4E2A target \u4E4B\u524D\u521B\u5EFA\u8FC7 proxy \uFF0C\u5219\u76F4\u63A5\u8FD4\u56DE\u5B58\u5728\u7684\u54CD\u5E94\u5F0F\u5BF9\u8C61\r\n  if (exisitingProxy) {\r\n    return exisitingProxy\r\n  }\r\n\r\n  /**\r\n   * \u521B\u5EFA target \u7684\u4EE3\u7406\u5BF9\u8C61\r\n   */\r\n  const proxy = new Proxy(target, mutableHandlers)\r\n\r\n  // \u5C06\u4E00\u4E2A target \u5BF9\u8C61\u4E0E\u5979\u76F8\u5173\u8054\u7684\u4EE3\u7406\u5BF9\u8C61\u8FDB\u884C\u5173\u8054\r\n  reactiveMap.set(target, proxy)\r\n\r\n  // \u4FDD\u5B58\u5DF2\u7ECF\u521B\u5EFA\u8FC7\u7684\u54CD\u5E94\u5F0F\u5BF9\u8C61\r\n  reactiveSet.add(proxy)\r\n\r\n  return proxy\r\n}\r\n\r\n/**\r\n * \u7ED1\u5B9A target \u7684 key \u5173\u8054\u7684\u6240\u6709\u7684 dep\r\n * obj = { a:0, b:1 }\r\n *\r\n * targetMap = {\r\n *  [obj]: {\r\n *      a: Dep\r\n *      b: Dep\r\n *  }\r\n * }\r\n * */\r\n\r\n/**\r\n * \u5224\u65AD target \u662F\u4E0D\u662F\u54CD\u5E94\u5F0F\u5BF9\u8C61\uFF0C\u53EA\u8981\u5728 reactiveSet \u4E2D\u5C31\u662F\u54CD\u5E94\u5F0F\u5BF9\u8C61\uFF0C\u539F\u7248\u7684\u903B\u8F91\u662F\u4E0E isRef \u7C7B\u4F3C\uFF0C\u5728 ref \u4E2D\u5EFA\u7ACB\u53D8\u91CF\uFF0C\u7136\u540E\u5728 reactive \u4E2D\u5224\u65AD\u4E0E\u8BBE\u7F6E\r\n * @param target\r\n * @returns\r\n */\r\nexport function isReactive(target) {\r\n  return reactiveSet.has(target)\r\n}\r\n", "import { hasChanged, isObject } from 'packages/shared/src/utils'\r\nimport { activeSub, ReactiveEffect } from './effect'\r\nimport { Dependency, link, propagate, Link } from './system'\r\nimport { reactive, isReactive } from './reavtive'\r\n\r\nexport enum ReactiveFlags {\r\n  IS_REF = '__v_isRef',\r\n}\r\n\r\n/**\r\n * ref \u7684\u7C7B \u7528\u6765\u4FDD\u5B58\u503C\r\n */\r\nclass RefImpl implements Dependency {\r\n  // \u4FDD\u5B58\u5B9E\u9645\u7684\u503C\r\n  _value\r\n\r\n  // \u8BA2\u9605\u8005\u94FE\u8868\u7684\u5934\u8282\u70B9\uFF0C\u7406\u89E3\u4E3A\u94FE\u8868\u4E2D\u7684 head\r\n  subs: Link\r\n\r\n  // \u8BA2\u9605\u8005\u94FE\u8868\u7684\u5C3E\u8282\u70B9\uFF0C\u7406\u89E3\u4E3A\u94FE\u8868\u4E2D\u7684 tail\r\n  subsTail: Link;\r\n\r\n  // ref \u7684\u6807\u8BB0\uFF0C\u8BC1\u660E\u662F ref\r\n  [ReactiveFlags.IS_REF] = true\r\n\r\n  constructor(value) {\r\n    //  \u5982\u679C value \u662F\u4E00\u4E2A\u5BF9\u8C61\u5219\u4F7F\u7528 reactive \u8F6C\u6362\u4E3A\u54CD\u5E94\u5F0F\r\n    this._value = isObject(value) ? reactive(value) : value\r\n  }\r\n\r\n  get value() {\r\n    // \u6536\u96C6\u4F9D\u8D56\r\n    if (activeSub) {\r\n      trackRef(this)\r\n    }\r\n    return this._value\r\n  }\r\n\r\n  set value(newValue) {\r\n    // \u53EA\u6709\u503C\u53D1\u751F\u53D8\u5316\u624D\u89E6\u53D1\u66F4\u65B0\r\n    if (hasChanged(newValue, this._value)) {\r\n      // \u89E6\u53D1\u66F4\u65B0\r\n      // \u5982\u679C newValue \u662F\u4E00\u4E2A\u5BF9\u8C61\u5219\u4F7F\u7528 reactive \u8F6C\u6362\u4E3A\u54CD\u5E94\u5F0F\r\n      this._value = isObject(newValue) ? reactive(newValue) : newValue\r\n    }\r\n\r\n    triggerRef(this)\r\n  }\r\n}\r\n\r\n/**\r\n *  ref \u51FD\u6570\r\n */\r\nexport function ref(value) {\r\n  return new RefImpl(value)\r\n}\r\n\r\n/**\r\n * isref \u51FD\u6570\r\n * \u5224\u65AD\u662F\u5426\u4E3A ref\r\n */\r\nexport function isRef(value) {\r\n  return !!(value && value[ReactiveFlags.IS_REF])\r\n}\r\n\r\n/**\r\n * \u6536\u96C6 ref \u7684\u76F8\u5173\u4F9D\u8D56\uFF0C\u5E76\u4E14\u5EFA\u7ACB ref \u4E0E effect \u4E4B\u95F4\u7684\u94FE\u8868\u5173\u7CFB\r\n * @param dep\r\n */\r\nexport function trackRef(dep) {\r\n  if (activeSub) {\r\n    link(dep, activeSub)\r\n  }\r\n}\r\n\r\n/**\r\n * \u89E6\u53D1 ref \u5173\u8054\u7684 effect \u91CD\u65B0\u6267\u884C\r\n * @param dep\r\n */\r\nexport function triggerRef(dep) {\r\n  if (dep.subs) {\r\n    propagate(dep.subs)\r\n  }\r\n}\r\n\r\nclass ObjectRefImpl {\r\n  [ReactiveFlags.IS_REF] = true\r\n\r\n  constructor(\r\n    public _object,\r\n    public _key,\r\n  ) {}\r\n\r\n  get value() {\r\n    return this._object[this._key]\r\n  }\r\n\r\n  set value(newVal) {\r\n    this._object[this._key] = newVal\r\n  }\r\n}\r\n/**\r\n * \u5C06\u4E00\u4E2A\u5BF9\u8C61\u5185\u7684\u67D0\u4E2A\u503C\u5355\u72EC\u63D0\u53D6\u51FA\u6765\u4F5C\u4E3A\u54CD\u5E94\u5F0F\u6570\u636E\r\n * @param target \u5BF9\u8C61\r\n * @param key \u503C\r\n * @returns\r\n */\r\nexport function toRef(target, key) {\r\n  return new ObjectRefImpl(target, key)\r\n}\r\n\r\n/**\r\n * \u5C06\u4E00\u4E2A\u54CD\u5E94\u5F0F\u5BF9\u8C61\u91CC\u7684\u6240\u6709\u5C5E\u6027\u8F6C\u6362\u4E3A\u54CD\u5E94\u5F0F\u6570\u636E\uFF0C\u5E76\u653E\u5728\u4E00\u4E2A\u5BF9\u8C61\u4E2D\u7ED9\u7528\u6237\u63D0\u53D6\r\n * @param target \u8981\u4ECE\u4E2D\u63D0\u53D6\u7684\u5BF9\u8C61\r\n * @returns\r\n */\r\nexport function toRefs(target) {\r\n  if (!isReactive(target)) {\r\n    console.warn('\u4F20\u5165\u7684\u503C\uFF0C\u5FC5\u987B\u4E3A\u54CD\u5E94\u5F0F\u5BF9\u8C61')\r\n  }\r\n\r\n  const res = {}\r\n\r\n  for (const key in target) {\r\n    res[key] = new ObjectRefImpl(target, key)\r\n  }\r\n\r\n  // \u8FD4\u56DE\u4E00\u4E2A\u5177\u6709\u539F\u5148 target \u91CC\u9762\u7684\u6240\u6709\u503C\u7684\u5BF9\u8C61\u3002\u5E76\u4E14\u8BE5\u5BF9\u8C61\u7684\u6BCF\u4E2A\u503C\u90FD\u9700\u8981\u53D8\u4E3A ObjectRefImple\r\n  return res\r\n}\r\n\r\n/**\r\n * \u5982\u679C\u53C2\u6570\u662F ref\uFF0C\u5219\u8FD4\u56DE\u5185\u90E8\u503C\uFF0C\u5426\u5219\u8FD4\u56DE\u53C2\u6570\u672C\u8EAB\r\n * @param value\r\n * @returns\r\n */\r\nexport function unRef(value) {\r\n  return isRef(value) ? value.value : value\r\n}\r\n\r\n/**\r\n * \u8BA9\u8FD9\u4E2A\u54CD\u5E94\u5F0F\u5BF9\u8C61\u91CC\u9762\u7684\u503C\u4E0D\u9700\u8981\u518D\u901A\u8FC7 .value \u53BB\u8BFB\u53D6\r\n *\r\n * AS: state.a.value ==> state.a\r\n *\r\n * @param target\r\n * @returns\r\n */\r\nexport function proxyRefs(target) {\r\n  return new Proxy(target, {\r\n    get(target, key, receiver) {\r\n      /**\r\n       * \u81EA\u52A8\u89E3\u5305 ref\r\n       * \u5982\u679C target[key] \u662F\u4E00\u4E2A ref \u5219\u8FD4\u56DE ref.value \uFF0C\u5426\u5219\u8FD4\u56DE target[key]\r\n       */\r\n\r\n      const res = Reflect.get(target, key, receiver)\r\n\r\n      return unRef(res)\r\n    },\r\n    set(target, key, newValue, receiver) {\r\n      const oldValue = target[key]\r\n      // \u5982\u679C\u66F4\u65B0 reactive \u91CC\u9762 a \u7684\u503C\u4E4B\u524D\u662F\u4E2A ref \uFF0C\u4E14\u65B0\u7684 ref \u4E0D\u662F\u4E00\u4E2A ref \u3002\u5219\u9700\u8981\u540C\u6B65\u4FEE\u6539 \u59CB a \u7684 ref \u7684\u503C\u4E3A newValue\r\n      // \u5982\u679C\u66F4\u65B0\u7684 newValue \u662F\u4E00\u4E2A ref \uFF0C\u90A3\u5C31\u4E0D\u9700\u8981\u540C\u6B65\u66F4\u65B0\r\n      if (isRef(oldValue) && !isRef(newValue)) {\r\n        /**\r\n         * const a = ref(0)\r\n         * target = { a}\r\n         *\r\n         * target.a = 1 \u5C31\u53EF\u4EE5\u770B\u4F5C a.value = 1\r\n         * a.value = 1\r\n         */\r\n        oldValue.value = newValue\r\n        return true\r\n      }\r\n\r\n      return Reflect.set(target, key, newValue, receiver)\r\n    },\r\n  })\r\n}\r\n", "import { hasChanged, isFunction } from 'packages/shared/src/utils'\r\nimport { ReactiveFlags } from './ref'\r\nimport { Link, Dependency, Sub, link, startTrack, endTrack } from './system'\r\nimport { activeSub, setActiveSub } from './effect'\r\n\r\nclass ComputedRefImpl implements Dependency, Sub {\r\n  // computed \u4E5F\u662F\u4E00\u4E2A ref \uFF0C\u901A\u8FC7 isRef \u4E5F\u8FD4\u56DE true\r\n  [ReactiveFlags.IS_REF] = true\r\n\r\n  // \u4FDD\u5B58 fn \u7684\u8FD4\u56DE\u503C\r\n  _value\r\n\r\n  //region \u4F5C\u4E3A dep,\u8981\u5173\u8054 subs \u5982\u679C\u503C\u53D1\u751F\u6539\u53D8\u5219\u901A\u77E5\u66F4\u65B0\r\n  // \u8BA2\u9605\u8005\u94FE\u8868\u7684\u5934\u8282\u70B9\uFF0C\u7406\u89E3\u4E3A\u94FE\u8868\u4E2D\u7684 head\r\n  subs: Link | undefined\r\n\r\n  // \u8BA2\u9605\u8005\u94FE\u8868\u7684\u5C3E\u8282\u70B9\uFF0C\u7406\u89E3\u4E3A\u94FE\u8868\u4E2D\u7684 tail\r\n  subsTail: Link | undefined\r\n  //endregion\r\n\r\n  //region  \u4F5C\u4E3A sub \uFF0C\u8981\u4FDD\u5B58\u88AB\u6211\u6536\u96C6\u7684 dep\r\n  // \u4F9D\u8D56\u94FE\u8868\u7684\u5934\u8282\u70B9\r\n  deps: Link | undefined\r\n\r\n  // \u4F9D\u8D56\u94FE\u8868\u7684\u5C3E\u8282\u70B9\r\n  depsTail: Link | undefined\r\n\r\n  // tracking \u7528\u4E8E\u5224\u65AD\u662F\u5426\u5DF2\u7ECF\u8FFD\u8E2A\r\n  tracking = false\r\n\r\n  //endregion\r\n\r\n  // \u8BA1\u7B97\u5C5E\u6027\u810F\u4E0D\u810F\uFF0C\u5982\u679C dirty \u4E3A true \u5219\u8BC1\u660E\u8BE5\u8BA1\u7B97\u662F\u810F\u7684, \u6240\u4EE5 get \u548C set \u7684\u65F6\u5019\uFF0C\u9700\u8981\u6267\u884C update\r\n  dirty = true\r\n\r\n  constructor(\r\n    public fn,\r\n    private setter,\r\n  ) {}\r\n\r\n  get value() {\r\n    if (this.dirty) {\r\n      //\u5982\u679C\u8BA1\u7B97\u5C5E\u6027\u810F\u4E86\u5219 update\r\n      this.update()\r\n    }\r\n    /**\r\n     * \u4F5C\u4E3A dep(ref) \uFF0C\u4E3A\u4E86\u5B9E\u73B0 dep \u529F\u80FD\uFF0C\u8981\u548C sub(effect) \u5173\u8054\u5173\u7CFB\r\n     */\r\n    if (activeSub) {\r\n      link(this, activeSub)\r\n    }\r\n\r\n    return this._value\r\n  }\r\n\r\n  set value(newValue) {\r\n    if (this.setter) {\r\n      this.setter(newValue)\r\n    } else {\r\n      console.warn('\u6211\u662F\u53EA\u8BFB\u7684\uFF0C\u65E0\u6CD5\u91CD\u65B0\u8D4B\u503C')\r\n    }\r\n  }\r\n\r\n  update() {\r\n    /** \u4F5C\u4E3A sub(effect) \u5B9E\u73B0 sub \u7684\u529F\u80FD\uFF0C\u4E3A\u4E86\u5728\u6267\u884C fn \u671F\u95F4\uFF0C\u6536\u96C6 fn \u6267\u884C\u8FC7\u7A0B\u4E2D\u8BBF\u95EE\u5230\u7684\u54CD\u5E94\u5F0F\u6570\u636E\r\n     * \u5EFA\u7ACB dep \u548C sub \u4E4B\u95F4\u7684\u5173\u8054\u5173\u7CFB\r\n     */\r\n    // \u5148\u5C06\u5F53\u524D\u7684 effect \u4FDD\u5B58\u8D77\u6765\uFF0C\u4ECE\u800C\u5904\u7406\u5D4C\u5957\u7684\u903B\u8F91\u3002\u5B58\u5728 effect \u5219\u4FDD\u5B58\uFF0C\u4E0D\u5B58\u5728\u5219\u4E3A undefined\r\n    const prevSub = activeSub\r\n\r\n    // \u6BCF\u6B21\u6267\u884C fn \u4E4B\u524D\u628A this \u5B58\u50A8\u5230 activeSub \u4E2D\uFF0C \u8FD9\u6837\u80FD\u591F\u4F7F\u540C\u4E00\u4E2A effect \u5185\u7684\u4F9D\u8D56\u6536\u96C6\u51FD\u6570\u4E2D\u7684 activeSub(sub) \u4E3A\u540C\u4E00\u4E2A\uFF0C\u4F7F\u5F97\u4ED6\u4EEC\u7684 deps \u548C depsTail \u80FD\u591F\u4E3A\u540C\u4E00\u4E2A\r\n    setActiveSub(this)\r\n\r\n    // \u6BCF\u6B21\u91CD\u65B0\u6267\u884C effect \u65F6\u9700\u8981\u5C06 depsTail \u8BBE\u7F6E\u4E3A undefined \u4ECE\u800C\u4F7F\u5F97 effect \u4F1A\u4ECE\u5934\u8282\u70B9\u5F00\u59CB\u6267\u884C\u51FD\u6570\r\n    startTrack(this)\r\n\r\n    try {\r\n      // \u62FF\u5230\u8001\u503C\r\n      const oldValue = this._value\r\n\r\n      // \u62FF\u5230\u65B0\u7684\u503C\r\n      this._value = this.fn()\r\n\r\n      // \u8FD4\u56DE\u503C\u6709\u6CA1\u6709\u53D8 \uFF0C\u503C\u53D1\u751F\u53D8\u5316\u5219\u8FD4\u56DE true\r\n      return hasChanged(this._value, oldValue)\r\n    } finally {\r\n      // \u6267\u884C\u5B8C\u6210\u540E\uFF0C\u9700\u8981\u5224\u65AD\u5F53\u524D depsTail \u662F\u5426\u5177\u6709 nextDep \uFF0C\u8FD9\u4E9B nextDep \u90FD\u662F\u9700\u8981\u6E05\u7406\u7684\u5185\u5BB9\uFF0C\u56E0\u4E3A\u4ED6\u5DF2\u7ECF\u4E0D\u6EE1\u8DB3\u65B0\u7684 effect \u51FD\u6570\r\n      endTrack(this)\r\n\r\n      // \u6267\u884C\u5B8C\u6210\u540E \u628A  activeSub \u6062\u590D\u4E3A\u4E4B\u524D\u7684 effects\r\n      setActiveSub(prevSub)\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n *  \u8BA1\u7B97\u5C5E\u6027\r\n * @param getterOrOptions \u6709\u53EF\u80FD\u4E3A\u51FD\u6570\uFF0C\u4E5F\u6709\u53EF\u80FD\u4E3A\u5BF9\u8C61\uFF0C\u5BF9\u8C61\u91CC\u9762\u5177\u6709 get \u548C set \u5C5E\u6027\r\n */\r\nexport function computed(getterOrOptions) {\r\n  let getter\r\n  let setter\r\n\r\n  if (isFunction(getterOrOptions)) {\r\n    /**\r\n     * const c = computed(()=>{})\r\n     */\r\n    getter = getterOrOptions\r\n  } else {\r\n    /**\r\n     * const c = computed({\r\n     *      get(){},\r\n     *      set(){}\r\n     * })\r\n     */\r\n    getter = getterOrOptions.get\r\n    setter = getterOrOptions.set\r\n  }\r\n\r\n  return new ComputedRefImpl(getter, setter)\r\n}\r\n", "import { isRef } from './ref'\r\nimport { ReactiveEffect } from './effect'\r\nimport { isFunction, isObject } from 'packages/shared/src/utils'\r\nimport { isReactive } from './reavtive'\r\n\r\n/**\r\n *\r\n * @param source \u8981\u76D1\u542C\u7684\u76F8\u5E94\u5185\u5BB9\r\n * @param cb \u89E6\u53D1\u7684\u56DE\u8C03\u51FD\u6570,\u5177\u6709 newValue \u548C oldValue\r\n * @param options \u76F8\u5E94\u7684\u76D1\u542C\u8BBE\u7F6E\uFF0C\u4F8B\u5982: \u4EC5\u89E6\u53D1\u4E00\u6B21\u3001\u7ACB\u5373\u89E6\u53D1 \u7B49\r\n * @returns\r\n */\r\nexport function watch(source, cb, options) {\r\n  let getter\r\n\r\n  let { immediate, once, deep } = options || {}\r\n\r\n  if (once) {\r\n    // \u5982\u679C once \u4F20\u4E86\uFF0C\u90A3\u5C31\u628A cb \u6539\u4E3A\u539F\u6765\u7684 cb \u52A0\u4E0A stop \u505C\u6B62\u76D1\u542C\r\n    const _cb = cb\r\n\r\n    cb = (...args) => {\r\n      _cb(...args)\r\n      stop()\r\n    }\r\n  }\r\n\r\n  if (isRef(source)) {\r\n    // \u5982\u679C\u503C\u4E3A ref \u5219\u8BBF\u95EE source.value \u4ECE\u800C\u6536\u96C6\u4F9D\u8D56\r\n    getter = () => source.value\r\n  } else if (isReactive(source)) {\r\n    // \u5982\u679C\u503C\u662F reactive \uFF0C\u5219\u9ED8\u8BA4 deep \u4E3A true\uFF0C\u5982\u679C deep \u4F20\u5165\u503C\uFF0C\u5219\u4EE5\u4F20\u5165\u7684\u4E3A\u4E3B\r\n    getter = () => source\r\n    if (!deep) {\r\n      deep = true\r\n    }\r\n  } else if (isFunction(source)) {\r\n    // \u5982\u679C source \u662F\u4E00\u4E2A\u51FD\u6570\uFF0C\u90A3\u4E48 getter \u5C31\u7B49\u4E8E source\r\n    getter = source\r\n  }\r\n\r\n  if (deep) {\r\n    const baseGetter = getter\r\n    const depth = deep === true ? Infinity : deep\r\n\r\n    getter = () => traverse(baseGetter(), depth)\r\n  }\r\n\r\n  let oldValue\r\n\r\n  let cleanup = null\r\n\r\n  function onClaenup(cb) {\r\n    cleanup = cb\r\n  }\r\n\r\n  /**\r\n   * \u7528\u6765\u751F\u6210\u9700\u8981\u76D1\u542C\u7684 source \u7684\u51FD\u6570\uFF0C\u5E76\u4E14\u6536\u96C6\u76F8\u5E94\u7684\u4F9D\u8D56\r\n   *  - \u5982\u679C source \u4E3A ref \u5219 getter \u8FD4\u56DE\u4E00\u4E2A source.value\r\n   *  - \u5982\u679C source \u4E3A reactive \u5219 getter \u76F4\u63A5\u8FD4\u56DE\u5F53\u524D\u7684 source\uFF0C\u5E76\u4E14\u9700\u8981\u5224\u65AD\u662F\u5426\u5B58\u5728 deep\r\n   *  - \u5982\u679C source \u4E3A function \u5219 getter \u76F4\u63A5\u4E3A\u5F53\u524D\u7684 source \u51FD\u6570\uFF0C\u4E0D\u9700\u8981\u8FD4\u56DE\r\n   */\r\n  function job() {\r\n    //  \u770B\u4E00\u4E0B\u662F\u5426\u9700\u8981\u6E05\u7406\u4E0A\u4E00\u6B21\u7684\u526F\u4F5C\u7528\uFF0C\u5982\u679C\u6709\u5C31\u6267\u884C\uFF0C\u6267\u884C\u5B8C\u6210\u540E\u7F6E\u7A7A\r\n    if (cleanup) {\r\n      cleanup()\r\n      cleanup = null\r\n    }\r\n\r\n    // \u6267\u884C effect.run \u62FF\u5230 getter \u7684\u8FD4\u56DE\u503C\uFF0C\u4E0D\u80FD\u76F4\u63A5\u6267\u884C getter \uFF0C\u56E0\u4E3A\u9700\u8981\u6536\u96C6\u4F9D\u8D56\r\n    const newValue = effect.run()\r\n\r\n    // \u6267\u884C\u7528\u6237\u56DE\u8C03\uFF0C\u628A newValue \u3001 oldValue \u548C onClaenup \u51FD\u6570 \u4F20\u5165\r\n    cb(newValue, oldValue, onClaenup)\r\n\r\n    // \u4E0B\u4E00\u6B21\u7684 oldValue \u7B49\u4E8E\u8FD9\u4E00\u6B21\u7684 newValue\r\n    oldValue = newValue\r\n  }\r\n\r\n  const effect = new ReactiveEffect(getter)\r\n\r\n  effect.scheduler = job\r\n\r\n  if (immediate) {\r\n    // \u5982\u679C\u5B58\u5728 immediate \u5219\u76F4\u63A5\u8FDB\u884C\u89E6\u53D1\r\n    job()\r\n  } else {\r\n    // \u8FD9\u4E00\u6B65\u6709\u4E24\u4E2A\u76EE\u7684: 1. \u62FF\u5230 oldValue  2. \u6536\u96C6\u4F9D\u8D56\r\n    oldValue = effect.run()\r\n  }\r\n\r\n  // \u505C\u6B62\u76D1\u542C\r\n  function stop() {\r\n    effect.stop()\r\n  }\r\n\r\n  return stop\r\n}\r\n\r\n/**\r\n * \u7528\u6765\u5BF9\u54CD\u5E94\u5F0F\u5BF9\u8C61\u8FDB\u884C\u6DF1\u5EA6\u76D1\u542C\u7684\u51FD\u6570\r\n * @param value \u76D1\u542C\u7684\u503C\r\n * @param depth \u9700\u8981\u6DF1\u5EA6\u76D1\u542C\u7684\u5C42\u6B21\uFF0C\u9ED8\u8BA4\u4E3A\u65E0\u7A77\r\n * @param seen \u7528\u4E8E\u5B58\u50A8\u5DF2\u7ECF\u904D\u5386\u8FC7\u7684\u503C\r\n * @returns\r\n */\r\nfunction traverse(value, depth = Infinity, seen = new Set()) {\r\n  //\u5982\u679C\u4E0D\u662F\u4E00\u4E2A\u5BF9\u8C61\u6216\u8005\u76D1\u542C\u5C42\u7EA7\u5230 0 \u5219\u76F4\u63A5\u8FD4\u56DE value\r\n  if (!isObject(value) || depth <= 0) {\r\n    // \u4E0D\u662F\u5BF9\u8C61\u5219\u9012\u5F52\r\n    return value\r\n  }\r\n\r\n  // \u67E5\u770B\u662F\u5426\u5DF2\u7ECF\u904D\u5386\u8FC7\uFF0C\u9632\u6B62\u6808\u6EA2\u51FA\r\n  if (seen.has(value)) {\r\n    return value\r\n  }\r\n\r\n  // \u5C42\u7EA7\u9010\u6B65\u51CF 1\r\n  depth--\r\n\r\n  // \u6DFB\u52A0\u5230 seen \u4E2D\uFF0C\u4EE5\u4FBF\u5224\u65AD\r\n  seen.add(value)\r\n\r\n  // \u662F\u5BF9\u8C61\u5219\u9012\u5F52\u5904\u7406\r\n  for (const key in value) {\r\n    traverse(value[key], depth, seen)\r\n\r\n    return value\r\n  }\r\n}\r\n", "import { isArray, hasOwn } from '@vue/shared'\r\nimport { reactive } from '@vue/reactivity'\r\n\r\n/**\r\n * \u6807\u51C6\u5316 props \uFF0C\u5F53\u7528\u6237\u4F20\u5165\u7684 props \u4E3A\u6570\u7EC4\u65F6\uFF0C\u5C06\u4ED6\u8F6C\u6362\u4E3A\u5BF9\u8C61\r\n * @param props\r\n * @returns\r\n */\r\nexport function normalizePropsOptions(props: {}) {\r\n  // \u5F53 props \u4E3A\u6570\u7EC4\u65F6\uFF0C\u628A\u4ED6\u8F6C\u6362\u4E3A\u5BF9\u8C61\r\n  if (isArray(props)) {\r\n    // \u628A\u6570\u7EC4\u8F6C\u6362\u4E3A\u5BF9\u8C61\uFF0C\u503C\u65E0\u6240\u8C13  ['msg', 'count] => { msg: true, count: true }\r\n    return props.reduce((prev, cur) => {\r\n      prev[cur] = {}\r\n\r\n      return prev\r\n    }, {})\r\n  }\r\n\r\n  return props\r\n}\r\n\r\n/**\r\n * \u521D\u59CB\u5316\u5C5E\u6027\r\n * @param instacne\r\n */\r\nexport function initProps(instance) {\r\n  // \u62FF\u5230\u7528\u6237\u4F20\u9012\u8FC7\u6765\u7684 props\r\n  const { vnode } = instance\r\n  const rawProps = vnode.props\r\n\r\n  // \u5C06 props \u5206\u4E3A props \u548C attrs\r\n  // 1. props: \u7531\u7528\u6237\u58F0\u660E\u7684\u5185\u5BB9\u5C31\u662F props\r\n  // 2. attrs: \u7528\u6237\r\n  const props = {}\r\n  const attrs = {}\r\n\r\n  // \u5BF9 props \u8FDB\u884C\u5206\u7C7B\r\n  setFullProps(instance, rawProps, props, attrs)\r\n\r\n  // \u5904\u7406\u5B8C\u6BD5\u540E\u5C06 props \u548C attrs \u90FD\u653E\u5230\u7EC4\u4EF6\u5B9E\u4F8B\u4E0A\r\n  // props \u662F\u54CD\u5E94\u5F0F\u7684\uFF0C\u56E0\u6B64\u9700\u8981 reactive\r\n  instance.props = reactive(props)\r\n\r\n  // attrs \u4E0D\u662F\u54CD\u5E94\u5F0F\u7684\r\n  instance.attrs = attrs\r\n}\r\n\r\n/**\r\n * \u8BBE\u7F6E\u6240\u6709\u7684 props attrs\uFF0C\u5C06\u7528\u6237\u4F20\u5165\u7684 props \u6839\u636E\u662F\u5426\u5DF2\u7ECF\u88AB\u7528\u6237\u58F0\u660E\u8FC7\u8FDB\u884C\u5206\u7C7B\r\n * @param instance\r\n * @param rawProps\r\n * @param props\r\n * @param attrs\r\n */\r\nfunction setFullProps(instance, rawProps, props, attrs) {\r\n  const propsOptions = instance.propsOptions\r\n\r\n  if (rawProps) {\r\n    for (const key in rawProps) {\r\n      const value = rawProps[key]\r\n      if (hasOwn(propsOptions, key)) {\r\n        // \u5982\u679C\u7528\u6237\u58F0\u660E\u7684 propsOptions \u4E2D\u6709\u5F53\u524D\u7684 key \u503C\uFF0C\u5C31\u653E\u5230 props \u4E2D\r\n        props[key] = value\r\n      } else {\r\n        // \u5426\u5219\u5C31\u653E\u5230 attrs \u4E2D\r\n        attrs[key] = value\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * \u66F4\u65B0\u5B50\u7EC4\u4EF6\u4E2D\u7684\u5C5E\u6027\r\n * @param instance\r\n * @param nextVnode\r\n */\r\nexport function updateProps(instance, nextVnode) {\r\n  const { props, attrs } = instance\r\n\r\n  const rawProps = nextVnode.props\r\n\r\n  // \u8BBE\u7F6E\u6240\u6709\u7684\u65B0\u7684\u5C5E\u6027\r\n  setFullProps(instance, rawProps, props, attrs)\r\n\r\n  // \u628A\u65B0\u7684\u6CA1\u6709\uFF0C\u8001\u7684\u6709\u7684\u4E1C\u897F\u5220\u9664\r\n  // old: { msg: '123', age:0} ==> new: { msg:'123 }\r\n  for (const key in props) {\r\n    if (!hasOwn(rawProps, key)) {\r\n      delete props[key]\r\n    }\r\n  }\r\n  for (const key in attrs) {\r\n    if (!hasOwn(rawProps, key)) {\r\n      delete attrs[key]\r\n    }\r\n  }\r\n}\r\n", "const resolvePromise = Promise.resolve()\r\n\r\n/**\r\n * \u5C06\u7528\u6237\u4F20\u9012\u7684\u51FD\u6570\u653E\u5230\u5FAE\u4EFB\u52A1\u4E2D\uFF0C\u6B64\u51FD\u6570\u7528\u4E8E\u7531\u4E8E\u6E32\u67D3\u51FD\u6570\u662F\u5F02\u6B65\uFF0C\u56E0\u6B64\u6709\u65F6\u5019\u4E00\u4E9B\u9700\u8981\u5BF9\u66F4\u65B0\u540E\u7684\u6570\u636E\u8FDB\u884C\u64CD\u4F5C\u7684\u51FD\u6570\u4E2D\u51FA\u73B0\u6570\u636E\u4E0D\u5BF9\u79F0\u7684\u60C5\u51B5(\u4E00\u822C\u662F\u51FD\u6570\u5185\u7684\u6570\u636E\u8FD8\u662F\u539F\u5148\u7684\u6570\u636E)\r\n *\r\n * @param fn\r\n * @returns\r\n */\r\nexport function nextTick(fn) {\r\n  return resolvePromise.then(() => {\r\n    fn.call(this)\r\n  })\r\n}\r\n\r\n/**\r\n * \u628A\u6E32\u67D3\u51FD\u6570\u653E\u5230\u5FAE\u4EFB\u52A1\u4E2D\uFF0C\u6E32\u67D3\u51FD\u6570\u662F\u5F53\u6570\u636E\u66F4\u65B0\u4E00\u6B21\u5C31\u4F1A\u89E6\u53D1\u4E00\u6B21\r\n * @param job\r\n */\r\nexport function queueJob(job) {\r\n  // \u8FD9\u91CC promise \u5916\u7684 job \u4E5F\u53EA\u4F1A\u6267\u884C\u4E00\u6B21\uFF0C\u56E0\u4E3A\u5B83\u672C\u8EAB\u7684 dirty \u7684\u5C5E\u6027\u5728\u66F4\u65B0\u524D\u4F1A\u88AB\u8BBE\u7F6E\u4E3A\u810F\uFF0C\u4F46\u7531\u4E8E\u8BE5\u51FD\u6570\u88AB\u653E\u5165\u5230\u5F02\u6B65\u961F\u5217\u4E2D\uFF0C\u56E0\u6B64\u8BE5\u51FD\u6570\u8FD8\u6CA1\u66F4\u65B0\u5B8C\uFF0C\u56FA\u4E0D\u4F1A\u518D\u89E6\u53D1\u4E00\u6B21\u66F4\u65B0\u51FD\u6570\r\n  resolvePromise.then(() => {\r\n    job()\r\n  })\r\n}\r\n", "import { ShapeFlags } from '@vue/shared'\r\n\r\nexport function initSlots(instance) {\r\n  const { slots, vnode } = instance\r\n\r\n  // \u7EC4\u4EF6\u7684\u5B50\u5143\u7D20\u662F\u4E00\u4E2A\u63D2\u69FD\r\n  if (vnode.shapeFlag & ShapeFlags.SLOTS_CHILDREN) {\r\n    const { children } = vnode\r\n    /**\r\n     * \u4E00\u5F00\u59CB \uFF1A slots = {}\r\n     * children = { header: () => h('div', 'hello')}\r\n     * \u7ED3\u675F: slots = { header: () => h('div', 'hello')}\r\n     */\r\n    for (const key in children) {\r\n      slots[key] = children[key]\r\n    }\r\n  }\r\n}\r\n\r\nexport function updateSlots(instance, vnode) {\r\n  const { slots } = instance\r\n\r\n  // \u7EC4\u4EF6\u7684\u5B50\u5143\u7D20\u662F\u4E00\u4E2A\u63D2\u69FD\r\n  if (instance.shapeFlag & ShapeFlags.SLOTS_CHILDREN) {\r\n    const { children } = vnode\r\n    /**\r\n     * \u66F4\u65B0\u65B0\u7684\u5B50\u5143\u7D20\u63D2\u69FD\r\n     * \u4E00\u5F00\u59CB \uFF1A slots = {header: () => h('div', 'hello')}\r\n     * children = { footer: () => h('div', 'hello')}\r\n     * \u7ED3\u675F: slots = { header: () => h('div', 'hello'), footer: () => h('div', 'hello')}\r\n     */\r\n    for (const key in children) {\r\n      slots[key] = children[key]\r\n    }\r\n\r\n    /**\r\n     * \u5220\u9664\u6389\u8001\u6709\u65B0\u7684\u6CA1\u6709\u7684\u63D2\u69FD\r\n     * \u4E00\u5F00\u59CB \uFF1A slots = { header: () => h('div', 'hello'), footer: () => h('div', 'hello')}\r\n     * children = { footer: () => h('div', 'hello')}\r\n     * \u7ED3\u675F: slots = { footer: () => h('div', 'hello')}\r\n     */\r\n    for (const key in slots) {\r\n      if (children[key] == null) {\r\n        delete slots[key]\r\n      }\r\n    }\r\n  }\r\n}\r\n", "import { proxyRefs } from '@vue/reactivity'\r\nimport { normalizePropsOptions, initProps } from './componentProps'\r\nimport { hasOwn, isFunction, isObject } from '@vue/shared'\r\nimport { nextTick } from './scheduler'\r\nimport { initSlots } from './componentSlots'\r\n\r\n/**\r\n * \u521B\u5EFA\u7EC4\u4EF6\u5B9E\u4F8B\r\n * @param vnode\r\n * @returns\r\n */\r\nexport function createComponentInstance(vnode) {\r\n  const { type } = vnode\r\n  const instance: any = {\r\n    type,\r\n    vnode,\r\n    render: null,\r\n    // setup \u8FD4\u56DE\u7684\u5185\u5BB9\r\n    setupState: {},\r\n    // \u7528\u6237\u58F0\u660E\u7684\u7EC4\u4EF6 props\r\n    propsOptions: normalizePropsOptions(type.props),\r\n    props: {},\r\n    attrs: {},\r\n    // \u7EC4\u4EF6\u7684\u63D2\u69FD\r\n    slots: {},\r\n    refs: {},\r\n    // \u5B50\u6811\uFF0C render \u7684\u8FD4\u56DE\u503C\r\n    subTree: null,\r\n    // \u7EC4\u4EF6\u662F\u5426\u5DF2\u7ECF\u6302\u8F7D\r\n    isMounted: false,\r\n  }\r\n\r\n  instance.ctx = { _: instance }\r\n\r\n  // \u5C06\u7EC4\u4EF6\u4F20\u9012\u7684\u4E8B\u4EF6(emit) \u8FDB\u884C\u5B58\u50A8\r\n  instance.emit = (event, ...args) => emit(instance, event, ...args)\r\n  // \u5199\u6CD5\u4E8C: instance.emit = emit.bind(null, instance)  bind \u7B2C\u4E00\u4F4D\u4E3A null \u65F6\uFF0C\u8868\u793A\u7ED1\u5B9A\u4E3A\u5168\u5C40\u5BF9\u8C61\r\n\r\n  return instance\r\n}\r\n\r\n/**\r\n * \u521D\u59CB\u5316\u7EC4\u4EF6\u72B6\u6001\r\n */\r\nexport function setupComponent(instance) {\r\n  /**\r\n   * 1. \u521D\u59CB\u5316\u5C5E\u6027\r\n   * 2. \u521D\u59CB\u5316\u63D2\u69FD\r\n   * 3. \u521D\u59CB\u5316\u72B6\u6001\r\n   */\r\n\r\n  // \u521D\u59CB\u5316\u5C5E\u6027\r\n  initProps(instance)\r\n\r\n  // \u521D\u59CB\u5316\u63D2\u69FD\r\n  initSlots(instance)\r\n\r\n  // \u521D\u59CB\u5316\u72B6\u6001\r\n  setupStatefulComponent(instance)\r\n}\r\n\r\n/**\r\n * \u5B58\u50A8 attrs \u3001 slots \u7B49\uFF0C\u4F7F\u5F97\u7528\u6237\u53EF\u4EE5\u83B7\u53D6\u91CC\u9762\u7684\u6570\u636E\r\n */\r\nconst publicPropertiesMap = {\r\n  $el: instance => instance.vnode.el,\r\n  $attrs: instance => instance.attrs,\r\n  $slots: instance => instance.slots,\r\n  $refs: instance => instance.refs,\r\n  $emit: instance => instance.emit,\r\n  $nextTick: instance => {\r\n    return nextTick.bind(instance)\r\n  },\r\n  $forceUpdate: instance => {\r\n    return () => instance.update()\r\n  },\r\n}\r\n\r\nconst publicInstacneProxyHandlers = {\r\n  get(target, key) {\r\n    const { _: instance } = target\r\n\r\n    const { setupState, props } = instance\r\n\r\n    /**\r\n     * \u5F53\u8BBF\u95EE\u67D0\u4E2A\u5C5E\u6027\u65F6\uFF0C\u5148\u53BB setupState \u4E2D\u627E\uFF0C\u518D\u5230 props \u4E2D\u627E\r\n     */\r\n\r\n    if (hasOwn(setupState, key)) {\r\n      return setupState[key]\r\n    }\r\n\r\n    if (hasOwn(props, key)) {\r\n      return props[key]\r\n    }\r\n\r\n    /**\r\n     * $attrs\r\n     * $slots\r\n     * $refs\r\n     */\r\n    if (hasOwn(publicPropertiesMap, key)) {\r\n      const publicGetter = publicPropertiesMap[key]\r\n\r\n      return publicGetter(instance)\r\n    }\r\n\r\n    // \u5982\u679C\u5B9E\u5728\u6CA1\u6709\u5C31\u53EA\u80FD\u4E2D\u6574\u4E2A\u5B9E\u4F8B\u4E2D\u627E\r\n    return instance[key]\r\n  },\r\n\r\n  set(target, key, value) {\r\n    const { _: instance } = target\r\n\r\n    // \u53EA\u80FD\u4FEE\u6539 setup \u91CC\u9762\u7684\u6570\u636E\uFF0C\u4E0D\u80FD\u4FEE\u6539 props \u4E2D\u7684\u6570\u636E\r\n    const { setupState } = instance\r\n\r\n    if (hasOwn(setupState, key)) {\r\n      setupState[key] = value\r\n    }\r\n\r\n    return true\r\n  },\r\n}\r\n\r\nfunction setupStatefulComponent(instance) {\r\n  const type = instance.type\r\n\r\n  // \u521B\u5EFA\u4EE3\u7406\u5BF9\u8C61\uFF0C\u5185\u90E8\u8BBF\u95EE setupState props $attrs $slots\r\n  instance.proxy = new Proxy(instance.ctx, publicInstacneProxyHandlers)\r\n\r\n  if (isFunction(type.setup)) {\r\n    const setupContext = createSetUpContext(instance)\r\n\r\n    // \u4FDD\u5B58 setupContext\r\n    instance.setupContext = setupContext\r\n\r\n    // \u8BBE\u7F6E\u5F53\u524D\u7EC4\u4EF6\u7684\u5B9E\u4F8B\r\n    setCurrentInstance(instance)\r\n\r\n    // \u6267\u884C setup \u51FD\u6570\r\n    const setupResult = type.setup(instance.props, setupContext)\r\n\r\n    // \u6E05\u9664\u5F53\u524D\u7EC4\u4EF6\u7684\u5B9E\u4F8B\r\n    unsetCurrentInstance()\r\n\r\n    /**\r\n     * setup \u7684\u8FD4\u56DE\u503C\u6709\u4E24\u79CD\uFF0C\u4E00\u79CD\u662F\u8FD4\u56DE\u5B58\u50A8\u6570\u636E\u7684\u5BF9\u8C61\uFF0C\u53E6\u4E00\u79CD\u662F\u4E00\u4E2A\u51FD\u6570\r\n     * \u5982\u679C setup \u7684\u8FD4\u56DE\u503C\u662F\u4E00\u4E2A\u51FD\u6570\uFF0C\u5219\u8BC1\u660E\u8BE5\u51FD\u6570\u662F render\r\n     *\r\n     * */\r\n    handleSetupResult(instance, setupResult)\r\n  }\r\n\r\n  if (!instance.render) {\r\n    // \u4E0A\u9762\u5904\u7406\u5B8C\u8FD8\u6CA1\u6709 render \u5219\u9700\u8981\u5230\u7EC4\u4EF6\u7684\u914D\u7F6E\u4E2D\u53BB\u62FF render\r\n    // \u5C06 render \u7ED1\u5B9A\u7ED9 instance\r\n    instance.render = type.render\r\n  }\r\n}\r\n\r\n/**\r\n * \u7528\u6765\u5904\u7406setup \u7684\u8FD4\u56DE\u503C\uFF0C\u6709\u4E24\u79CD\u60C5\u51B5\uFF0C\u4E00\u79CD\u662F\u8FD4\u56DE\u5B58\u50A8\u6570\u636E\u7684\u5BF9\u8C61\uFF0C\u53E6\u4E00\u79CD\u662F\u4E00\u4E2A\u51FD\u6570\r\n * @param instance\r\n * @param setupResult\r\n */\r\nfunction handleSetupResult(instance, setupResult) {\r\n  if (isFunction(setupResult)) {\r\n    // setup \u8FD4\u56DE\u7684\u662F\u51FD\u6570\uFF0C\u5219\u4E3A render\r\n    instance.render = setupResult\r\n  } else if (isObject(setupResult)) {\r\n    // setup \u8FD4\u56DE\u7684\u662F\u5BF9\u8C61\uFF0C\u5219\u4E3A \u72B6\u6001\r\n    // \u62FF\u5230 setup \u8FD4\u56DE\u7684\u72B6\u6001\r\n    instance.setupState = proxyRefs(setupResult)\r\n  }\r\n}\r\n\r\n/**\r\n * \u521B\u5EFA setUpContext(\u5F53\u524D\u7EC4\u4EF6\u7684\u53C2\u6570)\r\n * \u5C06 attrs | solt | emit \u7B49\uFF0C\u751F\u6210\u7136\u540E\u4F20\u9012\u7ED9 setup \u65B9\u6CD5\r\n * @param instance\r\n * @returns\r\n */\r\nfunction createSetUpContext(instance) {\r\n  return {\r\n    // \u5904\u7406 props \u4E4B\u5916\u7684\u5C5E\u6027\r\n    get attrs() {\r\n      return instance.attrs\r\n    },\r\n    // \u5904\u7406\u4E8B\u4EF6\r\n    emit(event, ...args) {\r\n      emit(instance, event, ...args)\r\n    },\r\n    // \u5904\u7406\u63D2\u69FD\r\n    slots: instance.slots,\r\n    // \u66B4\u9732\u5C5E\u6027\r\n    expose(exposed) {\r\n      // \u628A\u7528\u6237\u66B4\u9732\u7684\u5C5E\u6027\u653E\u5230\u5B9E\u4F8B\u4E2D\r\n      instance.exposed = exposed\r\n    },\r\n  }\r\n}\r\n\r\n/**\r\n * \u5C06 \u7236\u7EC4\u4EF6\u4F20\u9012\u7ED9\u5B50\u7EC4\u4EF6\u7684\u4E8B\u4EF6\u8FDB\u884C\u5904\u7406\uFF0C\u4ECE\u800C\u4F7F\u5F97\u5176\u80FD\u5728\u5B50\u7EC4\u4EF6\u4E2D\u8C03\u7528\uFF0C\u8C03\u7528\u65B9\u6CD5\u4E3A: \u7236\u7EC4\u4EF6: onFoo(...args){} ==> \u5B50\u7EC4\u4EF6: emit('foo', ...args)\r\n * \u7531\u4E8E emit \u540C\u65F6\u9700\u8981\u653E\u7F6E\u5230 instance \u4E2D\uFF0C\u56E0\u6B64\u5C06\u6574\u4E2A\u6267\u884C\u903B\u8F91\u8FDB\u884C\u5C01\u88C5\uFF0C\u4ECE\u800C\u590D\u7528\r\n * @param instance\r\n * @param event\r\n * @param args\r\n */\r\nfunction emit(instance, event, ...args) {\r\n  /**\r\n   * 1.\u8F6C\u6362\u4E8B\u4EF6\u540D\r\n   *  foo => onFoo\r\n   *  bar => onBar\r\n   * 2. \u62FF\u5230\u4E8B\u4EF6\r\n   * 3. \u5982\u679C\u4E8B\u4EF6\u662F\u4E00\u4E2A\u51FD\u6570\u5219\u8C03\u7528\r\n   */\r\n\r\n  // foo: event[0] = f   event.slice(1) = oo\r\n  const eventName = `on${event[0].toUpperCase() + event.slice(1)}`\r\n\r\n  const handler = instance.vnode.props[eventName]\r\n\r\n  if (isFunction(handler)) {\r\n    handler(...args)\r\n  }\r\n}\r\n\r\n/**\r\n * \u5F53\u524D\u7EC4\u4EF6\u7684\u5B9E\u4F8B\r\n */\r\nlet currentInstance = null\r\n\r\n/**\r\n * \u5C06\u5F53\u524D\u7EC4\u4EF6\u7684\u5B9E\u4F8B\u8BBE\u7F6E\u597D\r\n * @param instance\r\n */\r\nexport function setCurrentInstance(instance) {\r\n  currentInstance = instance\r\n}\r\n\r\n/**\r\n * \u83B7\u53D6\u5F53\u524D\u7EC4\u4EF6\u7684\u5B9E\u4F8B\uFF0C\u6CA1\u6709\u5219\u8FD4\u56DE null\r\n * @returns\r\n */\r\nexport function getCurrentInstance() {\r\n  return currentInstance\r\n}\r\n\r\n/**\r\n * \u6E05\u9664\u7EC4\u4EF6\u5B9E\u4F8B\r\n */\r\nexport function unsetCurrentInstance() {\r\n  currentInstance = null\r\n}\r\n\r\n/**\r\n * \u83B7\u53D6\u5230\u5B50\u7EC4\u4EF6\u66B4\u9732\u7684\u5C5E\u6027\u4EE5\u53CA\u516C\u5F00\u7684\u5C5E\u6027\r\n * expose \u5B50\u7EC4\u4EF6\u7ED9\u7236\u7EC4\u4EF6\u66B4\u9732\u7684\u65B9\u6CD5\uFF0C\u7236\u7EC4\u4EF6\u53EF\u4EE5\u901A\u8FC7 ref \u83B7\u53D6\r\n * \u5982\u679C\u5B50\u7EC4\u4EF6\u6709\u901A\u8FC7 expose \u66B4\u9732\u5185\u5BB9\uFF0C\u90A3\u4E48\u7236\u7EC4\u4EF6\u901A\u8FC7 ref \u53EA\u80FD\u62FF\u5230\u5B50\u7EC4\u4EF6\u66B4\u9732\u7684\u5185\u5BB9\u548C $slots | $props | ... \u8FD9\u4E9B\u5185\u5BB9\r\n * \u5982\u679C\u7528\u6237\u6CA1\u7528\u901A\u8FC7 expose \u66B4\u9732\u5185\u5BB9\uFF0C\u90A3\u7236\u7EC4\u4EF6\u901A\u8FC7 ref \u53EF\u4EE5\u83B7\u5F97 instance.proxy \u4E0A\u7684\u5185\u5BB9\r\n * @param instance\r\n * @returns\r\n */\r\nexport function getComponentPublicInstance(instance) {\r\n  // \u5C06\u521B\u5EFA\u7684\u4EE3\u7406\u5BF9\u8C61\u8FDB\u884C\u5B58\u50A8\uFF0C\u907F\u514D\u591A\u6B21\u521B\u5EFA\r\n  if (instance.exposedProxy) return instance.exposedProxy\r\n\r\n  if (instance.exposed) {\r\n    // \u5B50\u7EC4\u4EF6\u6709\u66B4\u9732\uFF0C\u7528\u6237\u53EF\u4EE5\u8BBF\u95EE expose \u548C publicPropertiesMap \u4E2D\u7684\u5185\u5BB9\r\n    instance.exposedProxy = new Proxy(proxyRefs(instance.exposed), {\r\n      get(target, key) {\r\n        // \u7528\u6237\u8BBF\u95EE expose \u91CC\u7684\u5185\u5BB9\r\n        if (key in target) {\r\n          return target[key]\r\n        }\r\n\r\n        // \u7528\u6237\u8BBF\u95EE $el \u7B49\u5185\u5BB9\r\n        if (key in publicPropertiesMap) {\r\n          // $el $props\r\n          return publicPropertiesMap[key](instance)\r\n        }\r\n      },\r\n    })\r\n\r\n    return instance.exposedProxy\r\n  } else {\r\n    // \u8BBF\u95EE\u5B9E\u4F8B\u7684 proxy \u4E5F\u5C31\u662F\u5B9E\u4F8B\u7684\u6240\u6709\u5185\u5BB9\r\n    return instance.proxy\r\n  }\r\n}\r\n\r\n// \u8BBE\u7F6E\u5F53\u524D\u5728\u6E32\u67D3\u7684\u7EC4\u4EF6\u7684\u5B9E\u4F8B\r\nlet currentRenderInstance = null\r\n/**\r\n * \u5728\u6E32\u67D3\u5F53\u524D\u7EC4\u4EF6\u65F6\u53BB\u83B7\u53D6\u5F53\u524D\u7EC4\u4EF6\u7684\u5B9E\u4F8B\r\n * @param instance\r\n */\r\nexport function setCurrentRenderingInstance(instance) {\r\n  currentRenderInstance = instance\r\n}\r\n\r\n/**\r\n * \u6E05\u9664\u5F53\u524D\u7EC4\u4EF6\u5728\u6E32\u67D3\u65F6\u7684\u5B9E\u4F8B\r\n */\r\nexport function unsetCurrentRenderingInstance() {\r\n  currentRenderInstance = null\r\n}\r\n\r\n/**\r\n * \u83B7\u53D6\u5F53\u524D\u7EC4\u4EF6\u5728\u6E32\u67D3\u65F6\u7684\u5B9E\u4F8B\r\n */\r\nexport function getCurrentRenderingInstance() {\r\n  return currentRenderInstance\r\n}\r\n", "import {\r\n  isArray,\r\n  isFunction,\r\n  isNumber,\r\n  isObject,\r\n  isString,\r\n  ShapeFlags,\r\n} from '@vue/shared'\r\nimport { getCurrentRenderingInstance } from './component'\r\n\r\n/**\r\n * \u6587\u672C\u8282\u70B9\u6807\u8BB0\r\n */\r\nexport const Text = Symbol('v-txt')\r\n\r\nexport function isSameVNodeType(n1, n2) {\r\n  return n1.type === n2.type && n1.key === n2.key\r\n}\r\n\r\n/**\r\n * \u6807\u51C6\u5316\u8282\u70B9\uFF0C\u5F53\u8282\u70B9\u4E3A string \u6216\u8005 number \u5219\u5C06\u5176\u8F6C\u6362\u4E3A\u5BF9\u8C61\r\n * @param vnode\r\n * @returns\r\n */\r\nexport function normalizeVnode(vnode) {\r\n  if (isString(vnode) || isNumber(vnode)) {\r\n    // \u5982\u679C\u662F\u5B57\u7B26\u4E32\u6216\u8005\u6570\u5B57\u5219\u9700\u8981\u8F6C\u6362\u4E3A\u8282\u70B9\u5BF9\u8C61\r\n\r\n    return createVNode(Text, null, String(vnode))\r\n  }\r\n  return vnode\r\n}\r\n\r\n/**\r\n * \u6839\u636E __v_isVNode \u5224\u65AD\u662F\u5426\u4E3A\u865A\u62DF\u8282\u70B9\r\n */\r\nexport function isVnode(value) {\r\n  return value?.__v_isVNode\r\n}\r\n\r\n/**\r\n * \u5C06 children \u6807\u51C6\u5316\r\n * @param children\r\n */\r\nfunction normalizeChildren(vnode, children) {\r\n  let { shapeFlag } = vnode\r\n\r\n  if (isArray(children)) {\r\n    // children = [h('p', 'hello'), h('p', 'world')]\r\n    shapeFlag |= ShapeFlags.ARRAY_CHILDREN\r\n  } else if (isObject(children)) {\r\n    // children = h(Child, null, { header: () => h('div', '\u7236\u7EC4\u4EF6\u4F20\u9012\u7684\u63D2\u69FD header')})\r\n    if (shapeFlag & ShapeFlags.COMPONENT) {\r\n      // \u5982\u679C\u662F\u4E2A\u7EC4\u4EF6\uFF0C\u90A3\u5C31\u662F\u63D2\u69FD\r\n      shapeFlag |= ShapeFlags.SLOTS_CHILDREN\r\n    }\r\n  } else if (isFunction(children)) {\r\n    // children = () => h('div', 'hello')\r\n    if (shapeFlag & ShapeFlags.COMPONENT) {\r\n      // \u5982\u679C\u662F\u4E2A\u7EC4\u4EF6\uFF0C\u90A3\u5C31\u662F\u63D2\u69FD\r\n      shapeFlag |= ShapeFlags.SLOTS_CHILDREN\r\n      children = { default: children }\r\n    }\r\n  } else if (isNumber(children) || isString(children)) {\r\n    // \u5982\u679C children \u662F number \u5219\u8F6C\u6362\u4E3A string\r\n    children = String(children)\r\n    shapeFlag |= ShapeFlags.TEXT_CHILDREN\r\n  }\r\n\r\n  // \u5C06 shapeFlag \u548C children \u8FDB\u884C\u5904\u7406\uFF0C\u5E76\u4E14\u91CD\u65B0\u8D4B\u503C\r\n  vnode.shapeFlag = shapeFlag\r\n  vnode.children = children\r\n\r\n  return children\r\n}\r\n\r\nfunction normalizeRef(ref) {\r\n  if (ref == null) return\r\n  return {\r\n    // \u539F\u59CB\u7684 ref\r\n    r: ref,\r\n    // \u5F53\u524D\u6B63\u5728\u6E32\u67D3\u7684\u7EC4\u4EF6\u7684\u5B9E\u4F8B\r\n    i: getCurrentRenderingInstance(),\r\n  }\r\n}\r\n\r\n/**\r\n * \u7528\u6765\u521B\u5EFA\u865A\u62DF\u8282\u70B9\u7684\u65B9\u6CD5\r\n * @param type \u8282\u70B9\u7684\u7C7B\u578B\r\n * @param props \u8282\u70B9\u643A\u5E26\u7684\u5C5E\u6027\r\n * @param children \u8282\u70B9\u7684\u5B50\u7EA7\r\n */\r\nexport function createVNode(type, props?, children = null) {\r\n  let shapeFlag = 0\r\n\r\n  // \u5904\u7406 type \u7684 shapeFlag\r\n  if (isString(type)) {\r\n    // div span p h1\r\n    shapeFlag = ShapeFlags.ELEMENT\r\n  } else if (isObject(type)) {\r\n    // \u6709\u72B6\u6001\u7684\u7EC4\u4EF6\r\n    shapeFlag = ShapeFlags.STATEFUL_COMPONENT\r\n  }\r\n\r\n  const vnode = {\r\n    // \u8BC1\u660E\u662F\u4E00\u4E2A\u865A\u62DF\u8282\u70B9  vnode\r\n    __v_isVNode: true,\r\n    type,\r\n    props,\r\n    children: null,\r\n    // **key** \u505A diff \u9700\u8981\u7684\r\n    key: props?.key,\r\n    // \u865A\u62DF\u8282\u70B9\u8981\u6302\u8F7D\u7684\u5143\u7D20\r\n    el: null,\r\n    // \u5982\u679C\u662F 9 \u5219\u8868\u793A type \u662F\u4E00\u4E2A dom \u5143\u7D20, children \u662F\u4E00\u4E2A\u5B57\u7B26\u4E32\r\n    shapeFlag,\r\n    // \u7ED1\u5B9A ref\r\n    ref: normalizeRef(props?.ref),\r\n  }\r\n\r\n  // \u5904\u7406 children \u7684\u6807\u51C6\u5316 \u548C shapeFlag\r\n  normalizeChildren(vnode, children)\r\n\r\n  return vnode\r\n}\r\n", "import { isArray, isObject } from 'packages/shared/src/index'\r\nimport { createVNode, isVnode } from './vnode'\r\n\r\n/**\r\n * h \u51FD\u6570\u7684\u4F7F\u7528\u65B9\u6CD5\r\n *  - 1. h('div', 'hellow world') \u7B2C\u4E8C\u4E2A\u53C2\u6570\u4E3A\u5B50\u8282\u70B9\r\n *  - 2. h('div', [h('span', 'hellow'), h('span', 'world')]) \u7B2C\u4E8C\u4E2A\u53C2\u6570\u4E3A\u5B50\u8282\u70B9\r\n *  - 3. h('div', h('span', 'hello')) \u7B2C\u4E8C\u4E2A\u53C2\u6570\u4E3A\u5B50\u8282\u70B9\r\n *  - 4. h('div', { class: 'container' }) \u7B2C\u4E8C\u4E2A\u53C2\u6570\u4E3A props\r\n * -------- \u4E09\u4E2A\u53C2\u6570 ---------\r\n *  - 5. h('div', { class: 'container' }, 'hellow world')\r\n *  - 6. h('div', { class: 'container' }, h('span', 'hellow world'))\r\n *  - 7. h('div', { class: 'container' }, h('span', 'hellow'), h('span', ' world'))\r\n *  - 8. h('div', { class: 'container' }, [h('span', 'hellow'), h('span', ' world')])\r\n */\r\n\r\nexport function h(type, propsOrChildren?, children?) {\r\n  // h \u51FD\u6570\u4E3B\u8981\u7684\u4F5C\u7528\u662F\u5BF9 createVNode \u505A\u4E00\u4E2A\u53C2\u6570\u6807\u51C6\u5316(\u5F52\u4E00\u5316) \uFF0C\u4E0D\u4F1A\u4EA7\u751F\u4E00\u4E2A\u865A\u62DF\u8282\u70B9\r\n  let l = arguments.length\r\n\r\n  if (l === 2) {\r\n    if (isArray(propsOrChildren)) {\r\n      return createVNode(type, null, propsOrChildren)\r\n    }\r\n    if (isObject(propsOrChildren)) {\r\n      // \u5BF9\u8C61\u6709\u4E24\u79CD: \u865A\u62DF\u8282\u70B9 || props\r\n      if (isVnode(propsOrChildren)) {\r\n        // h('div', h('span', 'hello'))\r\n        return createVNode(type, null, [propsOrChildren])\r\n      }\r\n      // h('div', { class: 'container' })\r\n      return createVNode(type, propsOrChildren, children)\r\n    }\r\n    // h('div', 'hellow world')\r\n    return createVNode(type, null, propsOrChildren)\r\n  } else {\r\n    if (l > 3) {\r\n      // h('div', { class: 'container' }, h('span', 'hellow'), h('span', ' world'))\r\n      // ==> h('div', { class: 'container' }, [h('span', 'hellow'), h('span', ' world')])\r\n      children = [...arguments].slice(2)\r\n    } else if (isVnode(children)) {\r\n      // h('div', { class: 'container' }, h('span', 'hellow world'))\r\n      children = [children]\r\n    }\r\n    return createVNode(type, propsOrChildren, children)\r\n  }\r\n}\r\n", "import { h } from './h'\r\n\r\nexport function createAppApi(render) {\r\n  return function createApp(rootComponent, rootProps) {\r\n    const app = {\r\n      _container: null,\r\n\r\n      mount(container) {\r\n        /**\r\n         * \u6839\u7EC4\u4EF6\r\n         * \u8981\u6302\u8F7D\u7684 container \u5BB9\u5668\r\n         */\r\n\r\n        // \u521B\u5EFA\u865A\u62DF\u8282\u70B9\r\n        const vnode = h(rootComponent, rootProps)\r\n\r\n        // \u5C06\u865A\u62DF\u8282\u70B9\u6302\u8F7D\u5728\u5BB9\u5668\u4E0A\r\n        render(vnode, container)\r\n\r\n        // \u5C06\u5BB9\u5668\u5907\u4EFD\u4E00\u4EFD\uFF0C\u65B9\u4FBF\u5378\u8F7D\r\n        app._container = container\r\n      },\r\n\r\n      // \u5378\u8F7D\u865A\u62DF\u8282\u70B9\r\n      unmount() {\r\n        render(null, app._container)\r\n      },\r\n    }\r\n\r\n    return app\r\n  }\r\n}\r\n", "import {\r\n  setCurrentRenderingInstance,\r\n  unsetCurrentRenderingInstance,\r\n} from './component'\r\n\r\n/**\r\n * \u5224\u65AD\u65B0\u8001 props \u662F\u5426\u4E00\u6837\uFF0C\u8FD9\u91CC\u7684 props \u662F\u4E00\u4E2A\u5BF9\u8C61\r\n * @param prevProps\r\n * @param nextProps\r\n */\r\nfunction hasPropsChanged(prevProps, nextProps) {\r\n  const prevKeys = Object.keys(prevProps)\r\n  const nextKeys = Object.keys(nextProps)\r\n\r\n  // \u65B0\u8001\u8282\u70B9\u7684\u957F\u5EA6\u4E0D\u540C\uFF0C\u9700\u8981\u66F4\u65B0\r\n  // old: {msg: '123', count: 0} ==> new: {msg:'123'}\r\n  if (nextKeys.length !== prevKeys.length) {\r\n    return true\r\n  }\r\n\r\n  // \u65B0\u8001\u8282\u70B9\u7684\u957F\u5EA6\u76F8\u540C\uFF0C\u4F46\u5185\u5BB9\u4E0D\u540C\uFF0C\u9700\u8981\u66F4\u65B0\r\n  // old: {msg: '123', count: 0} ==> new: {msg:'123', count: 1}\r\n  for (const key of nextKeys) {\r\n    if (nextKeys[key] !== prevProps[key]) {\r\n      return true\r\n    }\r\n  }\r\n\r\n  return false\r\n}\r\n\r\n/**\r\n * \u68C0\u6D4B\u65B0\u65E7\u8282\u70B9\u5185\u7684\u5185\u5BB9\u662F\u5426\u76F8\u540C\r\n * @param n1\r\n * @param n2\r\n */\r\nexport function shouldUpdateComponent(n1, n2) {\r\n  const { props: prevProps, children: prevChildren } = n1\r\n  const { props: nextProps, children: nextChildren } = n2\r\n\r\n  // \u4EFB\u610F\u4E00\u4E2A\u5177\u6709\u63D2\u69FD\u5C31\u9700\u8981\u66F4\u65B0\r\n  if (prevChildren || nextChildren) {\r\n    return true\r\n  }\r\n\r\n  // \u8001\u7684\u6CA1\u6709\uFF0C\u65B0\u7684\u6709\u5219\u9700\u8981\u66F4\u65B0\r\n  if (!prevProps) {\r\n    return !!nextProps\r\n  }\r\n\r\n  // \u8001\u7684\u6709\uFF0C\u65B0\u7684\u6CA1\u6709\uFF0C\u4E5F\u9700\u8981\u66F4\u65B0\r\n  if (!nextProps) {\r\n    return true\r\n  }\r\n\r\n  // \u8001\u7684\u6709\uFF0C\u65B0\u7684\u4E5F\u6709\uFF0C\u5224\u65AD props \u662F\u5426\u6539\u53D8\r\n  return hasPropsChanged(prevProps, nextProps)\r\n}\r\n\r\nexport function renderComponentRoot(instance) {\r\n  // \u5C06\u5F53\u524D\u6E32\u67D3\u7684\u7EC4\u4EF6\u5B9E\u4F8B\u5B58\u50A8\u8D77\u6765\r\n  setCurrentRenderingInstance(instance)\r\n\r\n  // \u5C06\u5B50\u6811\u7684 this \u6307\u5411 setupState \u4ECE\u800C\u80FD\u591F\u4F7F\u7528 setupState \u8FD4\u56DE\u7684\u72B6\u6001\r\n  const subTree = instance.render.call(instance.proxy)\r\n\r\n  // \u6E05\u9664\u5B58\u50A8\u7684\u5B9E\u4F8B\r\n  unsetCurrentRenderingInstance()\r\n\r\n  return subTree\r\n}\r\n", "import {\r\n  getCurrentInstance,\r\n  setCurrentInstance,\r\n  unsetCurrentInstance,\r\n} from './component'\r\n\r\nexport enum LifeCycleHooks {\r\n  // \u6302\u8F7D instance.bm\r\n  BEFORE_MOUNT = 'bm',\r\n  MOUNTED = 'm',\r\n\r\n  // \u66F4\u65B0\r\n  BEFORE_UPDATE = 'bu',\r\n  UPDATED = 'u',\r\n\r\n  // \u5378\u8F7D\r\n  BEFORE_UNMOUNTED = 'bum',\r\n  UNMOUNTED = 'um',\r\n}\r\n\r\n/**\r\n * \u7528\u6765\u521B\u5EFA\u751F\u547D\u5468\u671F\u51FD\u6570\u7684\r\n * @param type\r\n * @returns\r\n */\r\nfunction createHook(type) {\r\n  return (hook, target = getCurrentInstance()) => {\r\n    injectHook(target, hook, type)\r\n  }\r\n}\r\n\r\n/**\r\n * \u6CE8\u5165\u751F\u547D\u5468\u671F\uFF0C\u5C06\u56DE\u8C03\u51FD\u6570\u653E\u5230\u5B9E\u4F8B\u4E0A\u5BF9\u5E94\u7684\u751F\u547D\u5468\u671F\u6807\u8BB0\u4E2D\r\n * @param target \u5F53\u524D\u7EC4\u4EF6\u7684\u5B9E\u4F8B\r\n * @param hook \u7528\u6237\u4F20\u9012\u7684\u56DE\u8C03\u51FD\u6570\r\n * @param type \u751F\u547D\u5468\u671F 'bm' 'bum'\r\n */\r\nfunction injectHook(target, hook, type) {\r\n  // \u4E00\u5F00\u59CB\u5B9E\u4F8B\u4E0A\u7684\u8FD9\u4E2A\u751F\u547D\u5468\u671F\u4E2D\u6CA1\u6709\u503C\uFF0C\u5219\u5C06\u5176\u8BBE\u7F6E\u4E3A\u6570\u7EC4\uFF0C\u7136\u540E\u5C06\u9700\u8981\u6267\u884C\u7684\u51FD\u6570 push \u8FDB\u53BB\r\n  if (target[type] == null) {\r\n    target[type] = []\r\n  }\r\n\r\n  // \u5C06 hook \u8FDB\u884C\u5305\u88C5\uFF0C\u786E\u4FDD\u7528\u6237\u53EF\u4EE5\u5728\u751F\u547D\u5468\u671F\u51FD\u6570\u4E2D\u8BBF\u95EE\u5230\u5B9E\u4F8B\r\n  const _hook = () => {\r\n    // \u5C06\u5F53\u524D\u7684\u5B9E\u4F8B\u8FDB\u884C\u8BBE\u7F6E\uFF0C\u4ECE\u800C\u4F7F\u5F97\u80FD\u591F\u5728\u751F\u547D\u5468\u671F\u4E2D\u83B7\u53D6\u5230\r\n    setCurrentInstance(target)\r\n\r\n    // \u6267\u884C\u751F\u547D\u5468\u671F\u7684\u56DE\u8C03\u51FD\u6570\r\n    hook()\r\n\r\n    // \u6E05\u7A7A\u5B9E\u4F8B\r\n    unsetCurrentInstance\r\n  }\r\n\r\n  // \u5C06\u8BE5\u751F\u547D\u5468\u671F\u7C7B\u578B\u4E2D\u7684 \u56DE\u8C03\u51FD\u6570 \u653E\u7F6E\u5230\u6570\u7EC4\u4E2D\r\n  target[type].push(_hook)\r\n}\r\n\r\n/**\r\n * \u89E6\u53D1\u76F8\u5E94\u7684\u751F\u547D\u5468\u671F\u51FD\u6570\r\n * @param instance \u5F53\u524D\u7684\u7EC4\u4EF6\u5B9E\u4F8B\r\n * @param type \u751F\u547D\u5468\u671F\u7684\u7C7B\u578B\r\n */\r\nexport function triggerHooks(instance, type) {\r\n  // \u62FF\u5230\u5F53\u524D\u9700\u8981\u89E6\u53D1\u7684\u751F\u547D\u5468\u671F\u7C7B\u578B\r\n  const hooks = instance[type]\r\n\r\n  // \u6709\u5219\u4F9D\u6B21\u6267\u884C\r\n  if (hooks) {\r\n    // getCurrentInstance(instance)\r\n    hooks.forEach(hook => hook())\r\n    // unsetCurrentInstance()\r\n  }\r\n}\r\n\r\n/**\r\n * \u7EC4\u4EF6\u7684\u751F\u547D\u5468\u671F\r\n *\r\n * \u6302\u8F7D\r\n * onBeforeMount\r\n * onMounted\r\n *\r\n * \u66F4\u65B0\r\n * onBeforeUpdate\r\n * onUpdated\r\n *\r\n * \u5378\u8F7D\r\n * onBeforeUnmount\r\n * onUnmounted\r\n *\r\n */\r\n// \u6302\u8F7D\r\nexport const onBeforeMount = createHook(LifeCycleHooks.BEFORE_MOUNT)\r\nexport const onMounted = createHook(LifeCycleHooks.MOUNTED)\r\n\r\n// \u66F4\u65B0\r\nexport const onBeforeUpdate = createHook(LifeCycleHooks.BEFORE_UPDATE)\r\nexport const onUpdated = createHook(LifeCycleHooks.UPDATED)\r\n\r\n// \u5378\u8F7D\r\nexport const onBeforeUnmount = createHook(LifeCycleHooks.BEFORE_UNMOUNTED)\r\nexport const onUnmounted = createHook(LifeCycleHooks.UNMOUNTED)\r\n", "import { isRef } from '@vue/reactivity'\r\nimport { isString, ShapeFlags } from '@vue/shared'\r\nimport { getComponentPublicInstance } from './component'\r\n\r\n/**\r\n * \u5C06\u5BF9\u5E94\u7684\u5143\u7D20\u7ED1\u5B9A\u5230 ref \u4E0A\r\n * @param ref\r\n * @param vnode\r\n */\r\nexport function setRef(ref, vnode) {\r\n  const { r: rawRef, i: instance } = ref\r\n  //   ref:{ r: \u7528\u6237\u66B4\u9732\u7684\u5185\u5BB9, i: \u5F53\u524D\u6E32\u67D3\u7684\u7EC4\u4EF6\u7684\u5B9E\u4F8B}\r\n\r\n  // \u5378\u8F7D ref\r\n  if (vnode == null) {\r\n    if (isRef(rawRef)) {\r\n      // \u5982\u679C\u662F ref\uFF0C\u5C31\u8BBE\u7F6E\u4E3A null\r\n      rawRef.value = null\r\n    } else if (isString(rawRef)) {\r\n      // \u5982\u679C\u662F\u5B57\u7B26\u4E32\u5C31\u4FEE\u6539 refs[rawRef] \u8BBE\u7F6E\u4E3A null\r\n      instance.refs[rawRef] = null\r\n    }\r\n\r\n    return\r\n  }\r\n\r\n  const { shapeFlag } = vnode\r\n\r\n  // \u6302\u8F7D ref\r\n  if (isRef(rawRef)) {\r\n    // \u5982\u679C rawRef \u662F\u4E00\u4E2A\u54CD\u5E94\u5F0F\u7684\r\n    if (shapeFlag & ShapeFlags.COMPONENT) {\r\n      // vnode \u662F\u7EC4\u4EF6\uFF0C \u5219\u83B7\u53D6\u5B50\u7EC4\u4EF6\u66B4\u9732\u7684\u5185\u5BB9\r\n      rawRef.value = getComponentPublicInstance(vnode.component)\r\n    } else {\r\n      // vnode \u662F\u4E00\u4E2A DOM \u5143\u7D20\uFF0C\u5219\u83B7\u53D6\u5176\u5143\u7D20\u5185\u5BB9\r\n      rawRef.value = vnode.el\r\n    }\r\n  } else if (isString(rawRef)) {\r\n    // \u628A vnode.el \u7ED1\u5B9A\u5230 instance.$ref[ref] \u4E0A\r\n    if (shapeFlag & ShapeFlags.COMPONENT) {\r\n      // vnode \u662F\u4E00\u4E2A\u7EC4\u4EF6\r\n      instance.refs[rawRef] = getComponentPublicInstance(vnode.component)\r\n    } else {\r\n      // DOM \u5143\u7D20\r\n      instance.refs[rawRef] = vnode.el\r\n    }\r\n  }\r\n}\r\n", "import { ShapeFlags } from '@vue/shared'\r\nimport { ReactiveEffect } from '@vue/reactivity'\r\nimport { isSameVNodeType, normalizeVnode, Text } from './vnode'\r\nimport { createAppApi } from './apiCreateApp'\r\nimport { createComponentInstance, setupComponent } from './component'\r\nimport { queueJob } from './scheduler'\r\nimport {\r\n  renderComponentRoot,\r\n  shouldUpdateComponent,\r\n} from './componentRenderUtils'\r\nimport { updateProps } from './componentProps'\r\nimport { updateSlots } from './componentSlots'\r\nimport { triggerHooks, LifeCycleHooks } from './apiLifecycle'\r\nimport { setRef } from './renderTemplateRef'\r\n\r\nexport function createRenderer(options) {\r\n  /**\r\n   * \u63D0\u4F9B\u80FD\u591F\u4F7F\u5F97 \u865A\u62DF\u8282\u70B9(vnode) \u6E32\u67D3\u5230\u9875\u9762\u4E0A\u7684\u529F\u80FD\r\n   */\r\n\r\n  const {\r\n    createElement: hostCreateElement,\r\n    insert: hostInsert,\r\n    remove: hostRemove,\r\n    setElementText: hostSetElementText,\r\n    createText: hostCreateText,\r\n    setText: hostSetText,\r\n    parentNode: hostParentNode,\r\n    nextSibling: hostNextSibling,\r\n    patchProp: hostPatchProp,\r\n  } = options\r\n\r\n  /**\r\n   * \u5F53\u6302\u8F7D\u7684\u8282\u70B9\u7684\u5B50\u8282\u70B9\u4E3A\u4E00\u4E2A\u6570\u7EC4\u65F6\uFF0C\u8C03\u7528\u6B64\u51FD\u6570\u6765\u6302\u8F7D\u6570\u7EC4\u4E2D\u7684\u5B50\u8282\u70B9\r\n   * @param children\r\n   * @param el\r\n   */\r\n  const mountChildren = (children, el) => {\r\n    for (let i = 0; i < children.length; i++) {\r\n      // \u5982\u679C children \u4E3A\u5B57\u7B26\u4E32\u5219\u5C06\u5B83\u8F6C\u6362\u4E3A\u5BF9\u8C61\r\n      const child = (children[i] = normalizeVnode(children[i]))\r\n\r\n      // \u901A\u8FC7\u9012\u5F52\u53BB\u6302\u8F7D\u5B50\u8282\u70B9\r\n      patch(null, child, el)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * \u6302\u8F7D\u8282\u70B9\u7684\u65B9\u6CD5\r\n   * @param vnode \u8981\u6302\u8F7D\u7684\u8282\u70B9\r\n   * @param container \u6302\u8F7D\u7684\u5BB9\u5668\r\n   */\r\n  const mountElement = (vnode, container, anchor = null) => {\r\n    /**\r\n     * 1. \u521B\u5EFA dom \u8282\u70B9\r\n     * 2. \u8BBE\u7F6E\u5B83\u7684 props\r\n     * 3. \u6302\u8F7D\u5B83\u7684\u5B50\u8282\u70B9\r\n     */\r\n\r\n    const { type, props, children, shapeFlag } = vnode\r\n\r\n    //\u521B\u5EFA dom \u8282\u70B9 ,\u521B\u5EFA div,span \u7B49\r\n    const el = hostCreateElement(type)\r\n\r\n    // \u5C06\u5F53\u524D vnode \u4E2D\u7684 el \u8FDB\u884C\u66F4\u65B0\uFF0C\u4F7F\u5F97\u5728 \u66F4\u65B0\u548C\u5378\u8F7D\u65F6\u5177\u6709\u4E00\u4E2A\u5185\u5BB9\u53EF\u4EE5\u590D\u7528\r\n    vnode.el = el\r\n\r\n    // \u8BBE\u7F6E props\r\n    if (props) {\r\n      for (const key in props) {\r\n        hostPatchProp(el, key, null, props[key])\r\n      }\r\n    }\r\n\r\n    // \u5904\u7406\u5B50\u8282\u70B9\r\n    if (shapeFlag & ShapeFlags.TEXT_CHILDREN) {\r\n      // \u5B50\u8282\u70B9\u4E3A\u6587\u672C\r\n      hostSetElementText(el, children)\r\n    } else if (shapeFlag & ShapeFlags.ARRAY_CHILDREN) {\r\n      // \u5B50\u8282\u70B9\u662F\u6570\u7EC4\r\n      mountChildren(children, el)\r\n    }\r\n\r\n    // \u6302\u8F7D\u5B50\u8282\u70B9\uFF0C\u628A el \u63D2\u5165 container \u4E2D\r\n    hostInsert(el, container, anchor)\r\n  }\r\n\r\n  /**\r\n   * \u9012\u5F52\u5378\u8F7D\u5B50\u8282\u70B9\u9700\u8981\u7528\u5230\u7684\u51FD\u6570\r\n   * @param children \u9700\u8981\u5220\u9664\u7684\u5B50\u8282\u70B9\uFF0C\u4E3A\u4E00\u4E2A\u6570\u7EC4\r\n   */\r\n  const unmountChildren = children => {\r\n    for (let i = 0; i < children.length; i++) {\r\n      unmount(children[i])\r\n    }\r\n  }\r\n\r\n  /**\r\n   * \u5378\u8F7D\u7EC4\u4EF6\u5B9E\u4F8B\r\n   * @param instance\r\n   */\r\n  const unmountComponent = instance => {\r\n    // \u751F\u547D\u5468\u671F\u5378\u8F7D\u524D\r\n    triggerHooks(instance, LifeCycleHooks.BEFORE_UNMOUNTED)\r\n\r\n    // \u628A subTree \u5378\u8F7D\u6389\r\n    unmount(instance.subTree)\r\n\r\n    // \u751F\u547D\u5468\u671F\u5378\u8F7D\u540E\r\n    triggerHooks(instance, LifeCycleHooks.UNMOUNTED)\r\n  }\r\n\r\n  /**\r\n   * \u5378\u8F7D\u8282\u70B9\u7528\u7684\u51FD\u6570\r\n   * @param vnode \u8981\u5378\u8F7D\u7684\u8282\u70B9\r\n   */\r\n  const unmount = vnode => {\r\n    const { shapeFlag, children, ref } = vnode\r\n\r\n    if (shapeFlag & ShapeFlags.COMPONENT) {\r\n      // \u5B50\u8282\u70B9\u4E3A\u7EC4\u4EF6\r\n      unmountComponent(vnode.component)\r\n    } else if (shapeFlag & ShapeFlags.ARRAY_CHILDREN) {\r\n      // \u5B50\u8282\u70B9\u4E3A\u6570\u7EC4\uFF0C\u9700\u8981\u9012\u5F52\u5378\u8F7D\r\n      unmountChildren(children)\r\n    }\r\n\r\n    // \u5C06\u5F53\u524D\u8282\u70B9\u5220\u9664\u6389\r\n    hostRemove(vnode.el)\r\n\r\n    if (ref != null) {\r\n      setRef(ref, null)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * \u66F4\u65B0\u8282\u70B9\r\n   * @param el\r\n   * @param oldProps\r\n   * @param newProps\r\n   */\r\n  const patchProps = (el, oldProps, newProps) => {\r\n    /**\r\n     * 1. \u628A\u8001\u7684 props \u5168\u90E8\u5220\u9664\r\n     * 2. \u628A\u65B0\u7684 props \u5168\u90E8\u8BBE\u7F6E\u4E0A\r\n     */\r\n    if (oldProps) {\r\n      // \u628A\u8001\u7684 props \u5168\u90E8\u5220\u9664\r\n      for (const key in oldProps) {\r\n        hostPatchProp(el, key, oldProps[key], null)\r\n      }\r\n    }\r\n\r\n    if (newProps) {\r\n      for (const key in newProps) {\r\n        hostPatchProp(el, key, oldProps?.[key], newProps[key])\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * \u66F4\u65B0\u5B50\u8282\u70B9\r\n   * @param n1\r\n   * @param n2\r\n   */\r\n  const patchChildren = (n1, n2) => {\r\n    const el = n2.el\r\n    /**\r\n     * 1. n2 \u7684\u5B50\u8282\u70B9\u7D20\u4E3A\u6587\u672C\r\n     *  - 1.1 \u8001\u7684\u5B50\u8282\u70B9\u662F\u6570\u7EC4\uFF0C\u65B0\u7684\u662F\u6587\u672C\r\n     *  - 1.2 \u8001\u7684\u5B50\u8282\u70B9\u662F\u6587\u672C\uFF0C\u65B0\u7684\u4E5F\u662F\u6587\u672C\r\n     * 2. n2 \u7684\u5B50\u8282\u70B9\u662F \u6570\u7EC4 \u6216\u8005 null\r\n     *  - 2.1 \u8001\u7684\u5B50\u8282\u70B9\u662F\u6587\u672C\uFF0C\u65B0\u7684\u662F\u6570\u7EC4\r\n     *  - 2.2 \u8001\u7684\u5B50\u8282\u70B9\u662F\u6570\u7EC4\uFF0C\u65B0\u7684\u4E5F\u662F\u6570\u7EC4\r\n     *  - 2.3 \u8001\u7684\u53EF\u80FD\u662F null\r\n     */\r\n    const prevShapeFlag = n1.shapeFlag\r\n    const shapeFlag = n2.shapeFlag\r\n\r\n    // \u65B0\u7684\u8282\u70B9\u662F\u6587\u672C\r\n    if (shapeFlag & ShapeFlags.TEXT_CHILDREN) {\r\n      // \u8001\u7684\u662F\u6570\u7EC4\uFF0C\u9700\u8981\u5378\u8F7D\u6389\u8001\u7684\r\n      if (prevShapeFlag & ShapeFlags.ARRAY_CHILDREN) {\r\n        unmountChildren(n1.children)\r\n      }\r\n\r\n      if (n1.children !== n2.children) {\r\n        // \u5982\u679C n1 \u548C n2 \u7684 children \u4E0D\u4E00\u6837\u3002\u76F4\u63A5\u8BBE\u7F6E\u6587\u672C\r\n        hostSetElementText(el, n2.children)\r\n      }\r\n    } else {\r\n      // \u65B0\u7684\u6709\u53EF\u80FD\u662F \u6570\u7EC4 \u6216\u8005 null\r\n      // \u8001\u7684\u4E5F\u6709\u53EF\u80FD\u662F \u6570\u7EC4 \u6216\u8005 null\r\n      if (prevShapeFlag & ShapeFlags.TEXT_CHILDREN) {\r\n        // \u8001\u7684\u662F\u6587\u672C\r\n        // \u628A\u8001\u5185\u5BB9\u5220\u9664\r\n        hostSetElementText(el, '')\r\n\r\n        if (shapeFlag & ShapeFlags.ARRAY_CHILDREN) {\r\n          // \u6302\u8F7D\u65B0\u7684\u8282\u70B9\r\n          mountChildren(n2.children, el)\r\n        }\r\n      } else {\r\n        // \u8001\u7684\u662F \u6570\u7EC4 \u6216\u8005 null\r\n        // \u65B0\u7684\u662F \u6570\u7EC4 \u6216\u8005 null\r\n        if (prevShapeFlag & ShapeFlags.ARRAY_CHILDREN) {\r\n          // \u8001\u7684\u662F\u6570\u7EC4\r\n          if (shapeFlag & ShapeFlags.ARRAY_CHILDREN) {\r\n            // \u65B0\u7684\u662F\u6570\u7EC4\uFF0C\u8001\u7684\u4E5F\u662F\u6570\u7EC4\uFF0C\u5168\u91CF diff\r\n            patchKeyedChildren(n1.children, n2.children, el)\r\n          } else {\r\n            // \u65B0\u7684\u662F null\uFF0C\u5378\u8F7D\u8001\u7684 \u6570\u7EC4\r\n            unmountChildren(n1.children)\r\n          }\r\n        } else {\r\n          // \u8001\u7684\u662F null\r\n          if (shapeFlag & ShapeFlags.ARRAY_CHILDREN) {\r\n            // \u65B0\u7684\u662F\u6570\u7EC4\uFF0C\u6302\u8F7D\u65B0\u7684\r\n            mountChildren(n2.children, el)\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  const patchKeyedChildren = (c1, c2, container) => {\r\n    /**\r\n     * \u5168\u91CF DIFF\r\n     * 1. \u53CC\u7AEF diff\r\n     *\r\n     * 1.1 \u5934\u90E8\u5BF9\u6BD4\r\n     * c1 = [a, b]\r\n     * c2 = [a, b, c]\r\n     *\r\n     * \u5F00\u59CB\u65F6\u7684\u53C2\u6570: i = 0 , e1 = 1, e2 = 2\r\n     * \u7ED3\u675F\u65F6\u7684\u53C2\u6570: i = 2 , e1 = 1, e2 = 2\r\n     *\r\n     * 1.2 \u5C3E\u90E8\u5BF9\u6BD4\r\n     * c1 = [a, b]\r\n     * c2 = [c, a, b]\r\n     *\r\n     * \u5F00\u59CB\u65F6\u7684\u53C2\u6570: i = 0 , e1 = 1, e2 = 2\r\n     * \u7ED3\u675F\u65F6\u7684\u53C2\u6570: i = 0 , e1 = -1, e2 = 0\r\n     *\r\n     * 2. \u4E71\u5E8F diff\r\n     * c1 = [a, b, c, d, e]\r\n     * c2 = [a, c, d, b, e]\r\n     *\r\n     * \u5F00\u59CB\u65F6\u7684\u53C2\u6570: i = 0 , e1 = 4, e2 = 4\r\n     * \u53CC\u7AEF\u5BF9\u6BD4\u5B8C\u65F6\u7684\u53C2\u6570: i = 1 , e1 = 3 , e2 = 3\r\n     */\r\n\r\n    // \u5F00\u59CB\u5BF9\u6BD4\u7684\u4E0B\u6807(\u6307\u9488)\r\n    let i = 0\r\n\r\n    // e1(\u65E7\u8282\u70B9) \u7684\u6700\u540E\u4E00\u4E2A\u5143\u7D20\u7684\u4E0B\u6807\r\n    let e1 = c1.length - 1\r\n\r\n    // e2(\u65B0\u8282\u70B9) \u7684\u6700\u540E\u4E00\u4E2A\u5143\u7D20\u7684\u4E0B\u6807\r\n    let e2 = c2.length - 1\r\n\r\n    /**\r\n     * \u5934\u90E8\u5BF9\u6BD4\r\n     * c1 = [a, b]\r\n     * c2 = [a, b, c]\r\n     *\r\n     * \u5F00\u59CB\u65F6\u7684\u53C2\u6570: i = 0 , e1 = 1, e2 = 2\r\n     * \u7ED3\u675F\u65F6\u7684\u53C2\u6570: i = 2 , e1 = 1, e2 = 2\r\n     */\r\n    while (i <= e1 && i <= e2) {\r\n      const n1 = c1[i]\r\n      const n2 = (c2[i] = normalizeVnode(c2[i]))\r\n\r\n      if (isSameVNodeType(n1, n2)) {\r\n        // n1 \u4E0E n2 \u662F\u540C\u4E00\u4E2A\u5B50\u8282\u70B9\uFF0C\u5219\u53EF\u4EE5\u66F4\u65B0\uFF0C\u66F4\u65B0\u5B8C\u540E\u7EE7\u7EED\u5BF9\u6BD4\u4E0B\u4E00\u4E2A\u5143\u7D20\r\n        patch(n1, n2, container)\r\n      } else {\r\n        break\r\n      }\r\n\r\n      i++\r\n    }\r\n\r\n    /**\r\n     * \u5C3E\u90E8\u5BF9\u6BD4\r\n     * c1 = [a, b]\r\n     * c2 = [c, a, b]\r\n     *\r\n     * \u5F00\u59CB\u65F6\u7684\u53C2\u6570: i = 0 , e1 = 1, e2 = 2\r\n     * \u7ED3\u675F\u65F6\u7684\u53C2\u6570: i = 0 , e1 = -1, e2 = 0\r\n     */\r\n    while (i <= e1 && i <= e2) {\r\n      const n1 = c1[e1]\r\n      const n2 = (c2[e2] = normalizeVnode(c2[e2]))\r\n\r\n      if (isSameVNodeType(n1, n2)) {\r\n        // n1 \u4E0E n2 \u662F\u540C\u4E00\u4E2A\u5B50\u8282\u70B9\uFF0C\u5219\u53EF\u4EE5\u66F4\u65B0\uFF0C\u66F4\u65B0\u5B8C\u540E\u7EE7\u7EED\u5BF9\u6BD4\u4E0A\u4E00\u4E2A\u5143\u7D20\r\n        patch(n1, n2, container)\r\n      } else {\r\n        break\r\n      }\r\n\r\n      e1--\r\n      e2--\r\n    }\r\n\r\n    // \u5F53 i \u6BD4 e1 \u5927\uFF0C\u610F\u5473\u7740\u65B0\u7684\u8282\u70B9\u4E2D\u7684\u5143\u7D20\u6BD4\u8001\u7684\u8282\u70B9\u4E2D\u7684\u5143\u7D20\u591A\uFF0C\u8981\u6302\u8F7D\u65B0\u7684\u8282\u70B9\r\n    if (i > e1) {\r\n      // \u62FF\u5230\u951A\u70B9\u7684\u4F4D\u7F6E\uFF0C\u4ECE\u800C\u65B9\u4FBF\u63D2\u5165\r\n      const nextPosition = e2 + 1\r\n\r\n      const anchor = nextPosition < c2.length ? c2[nextPosition].el : null\r\n\r\n      // \u65B0\u7684\u5185\u5BB9\u7684\u8303\u56F4\u662F i - e2\r\n      while (i <= e2) {\r\n        patch(null, (c2[i] = normalizeVnode(c2[i])), container, anchor)\r\n        i++\r\n      }\r\n    } else if (i > e2) {\r\n      // \u6839\u636E\u53CC\u7AEF\u5BF9\u6BD4\u5F97\u51FA\u7ED3\u679C\uFF0Ci > e2\uFF0C\u610F\u5473\u7740\u65B0\u8282\u70B9\u4E2D\u7684\u5143\u7D20\u6BD4\u8001\u8282\u70B9\u4E2D\u7684\u5143\u7D20\u5C11\uFF0C\u8981\u5378\u8F7D\u5143\u7D20\r\n      // \u5378\u8F7D\u7684\u8303\u56F4\u5728 i - e1\r\n      while (i <= e1) {\r\n        unmount(c1[i])\r\n        i++\r\n      }\r\n    } else {\r\n      /**\r\n       * 2. \u4E71\u5E8F diff\r\n       * c1 = [a, b, c, d, e]\r\n       * c2 = [a, c, d, b, e]\r\n       *\r\n       * \u5F00\u59CB\u65F6\u7684\u53C2\u6570: i = 0 , e1 = 4, e2 = 4\r\n       * \u53CC\u7AEF\u5BF9\u6BD4\u5B8C\u65F6\u7684\u53C2\u6570: i = 1 , e1 = 3 , e2 = 3\r\n       *\r\n       * \u627E\u5230 key \u76F8\u540C\u7684\u865A\u62DF\u8282\u70B9\uFF0C\u7136\u540E\u53BB patch \u4E00\u4E0B\r\n       * \u9700\u8981\u67E5\u627E\u7684\u8303\u56F4\u4E3A i - e1 \u548C i - e2\r\n       */\r\n\r\n      // \u65E7\u8282\u70B9\u4E2D\u7684 i\r\n      let s1 = i\r\n\r\n      // \u65B0\u8282\u70B9\u4E2D\u7684 i\r\n      let s2 = i\r\n\r\n      /**\r\n       * \u505A\u4E00\u4EFD\u65B0\u7684\u5B50\u8282\u70B9\u7684 key \u4E0E index \u4E4B\u95F4\u7684\u6620\u5C04\u5173\u7CFB\r\n       * map = {\r\n       *  c\uFF1A1\uFF0C\r\n       *  d: 2,\r\n       *  b: 3,\r\n       * }\r\n       */\r\n      const keyToNewIndexMap = new Map()\r\n\r\n      // \u4E00\u4E2A\u5B58\u50A8\u9700\u8981\u8FDB\u884C\u6C42\u6700\u957F\u9012\u589E\u5B50\u5E8F\u5217\u7684\u6570\u7EC4\r\n      const newIndexToOldIndexMap = new Array(e2 - s2 + 1)\r\n\r\n      // \u5148\u5168\u90E8\u586B\u5145 -1 \uFF0C\u540E\u9762\u503C\u4E3A -1 \u65F6\u8868\u793A\u4E0D\u662F\u540C\u65F6\u5728\u65B0\u65E7\u8282\u70B9\u4E0A\u7684\uFF0C\u6709\u53EF\u80FD\u662F\u65B0\u589E\u7684\u3002\u56E0\u6B64\u4E0D\u9700\u8981\u8BA1\u7B97\r\n      newIndexToOldIndexMap.fill(-1)\r\n\r\n      // \u904D\u5386 s2 \u5230 e2 \u4E4B\u95F4\u7684\u5143\u7D20\uFF0C\u7136\u540E\u5C06\u4ED6\u4EEC\u5B58\u50A8\u5230\u4E00\u4EFD \u952E\u540D\u4E3A: key \uFF0C\u952E\u503C\u4E3A index \u7684 map\r\n      for (let j = s2; j <= e2; j++) {\r\n        // \u4ECE\u65B0\u8282\u70B9\u4E2D\u62FF\u53D6\u5F53\u524D\u7D22\u5F15\u5BF9\u5E94\u7684\u5143\u7D20\uFF0C\u7136\u540E\u5B58\u5230 map \u4E2D\r\n        const n2 = (c2[j] = normalizeVnode(c2[j]))\r\n        keyToNewIndexMap.set(n2.key, j)\r\n      }\r\n\r\n      let pos = -1\r\n\r\n      // \u662F\u5426\u9700\u8981\u53BB\u8BA1\u7B97\u7136\u540E\u79FB\u52A8\r\n      let move = false\r\n\r\n      for (let j = s1; j <= e1; j++) {\r\n        // \u4ECE\u65E7\u8282\u70B9\u4E2D\u62FF\u53D6\u5F53\u524D\u7D22\u5F15\u5BF9\u5E94\u7684\u8282\u70B9\uFF0C\u7136\u540E\u5224\u65AD map \u4E2D\u662F\u5426\u5177\u6709\u76F8\u540C key \u503C\u7684\u8282\u70B9\r\n        const n1 = c1[j]\r\n        const newIndex = keyToNewIndexMap.get(n1.key)\r\n\r\n        // \u6709\u5219\u83B7\u53D6\u4ED6\u7684\u7D22\u5F15\uFF0C\u7136\u540E\u518D\u4ECE \u65B0\u8282\u70B9\u94FE \u4E2D\u83B7\u53D6\u51FA\u5143\u7D20\u8FDB\u884C patch\r\n        if (newIndex !== null) {\r\n          if (newIndex > pos) {\r\n            // \u5982\u679C\u5F53\u524D\u9879\u6BD4\u4E0A\u4E00\u4E2A\u5927\uFF0C\u610F\u5473\u7740\u5F53\u524D\u662F\u5904\u4E8E\u9012\u589E\u4E2D\uFF0C\u4E0D\u9700\u8981\u79FB\u52A8\u3002\u7136\u540E\u9700\u8981\u5C06 pos \u8BBE\u7F6E\u4E3A\u5F53\u524D\u9879\uFF0C\u65B9\u4FBF\u7EE7\u7EED\u5BF9\u6BD4\r\n            pos = newIndex\r\n          } else {\r\n            //  \u5982\u679C\u5F53\u524D\u9879\u6BD4\u4E0A\u4E00\u4E2A\u5C0F\uFF0C\u610F\u5473\u7740\u5DF2\u7ECF\u4E0D\u662F\u9012\u589E\u5E8F\u5217\uFF0C\u4ECE\u800C\u9700\u8981\u8FDB\u884C\u79FB\u52A8\r\n            move = true\r\n          }\r\n          newIndexToOldIndexMap[newIndex] = j\r\n          patch(n1, c2[newIndex], container)\r\n        } else {\r\n          // \u5982\u679C\u6CA1\u6709\u5219\u8868\u793A\u8001\u7684\u6709\uFF0C\u65B0\u7684\u6CA1\u6709\uFF0C\u9700\u8981\u5378\u8F7D\u8BE5\u5143\u7D20\r\n          unmount(n1)\r\n        }\r\n      }\r\n\r\n      // \u5982\u679C move \u4E3A false \u5219\u8868\u793A\u4E0D\u9700\u8981\u79FB\u52A8\uFF0C\u5C31\u4E0D\u8BA1\u7B97\r\n      const newIndexSequence = move ? getSequence(newIndexToOldIndexMap) : []\r\n      // \u66F4\u6362\u4E3A Set \u91C7\u7528 hash \u8868\uFF0C\u6027\u80FD\u66F4\u597D\r\n      const sequenctSet = new Set(newIndexSequence)\r\n\r\n      /**\r\n       * 1. \u904D\u5386\u65B0\u7684\u5B50\u5143\u7D20\uFF0C\u8C03\u6574\u987A\u5E8F\r\n       * \u4E0D\u9700\u8981\u5173\u5FC3\u539F\u5148\u7684\u987A\u5E8F\uFF0C\u53EA\u9700\u8981\u6309\u7167\u65B0\u7684\u5143\u7D20\u7684\u987A\u5E8F\u4ECE\u540E\u5F80\u524D\u63D2\u5165\u5373\u53EF\r\n       *\r\n       * 2. \u65B0\u7684\u6709\uFF0C\u8001\u7684\u6CA1\u6709\u5219\u6CA1\u529E\u6CD5\u590D\u7528\uFF0C\u9700\u8981\u6302\u8F7D\u65B0\u7684\u5143\u7D20\r\n       */\r\n      for (let j = e2; j >= s2; j--) {\r\n        // \u5012\u5E8F\u63D2\u5165\uFF0C\u4ECE\u540E\u5F80\u524D\r\n        const n2 = c2[j]\r\n\r\n        // \u62FF\u5230\u4E0B\u4E00\u4E2A\u5B50\u5143\u7D20\uFF0C\u4ECE\u800C\u63D2\u5165\u5230\u5B83\u524D\u9762\r\n        const anchor = c2[j + 1]?.el || null\r\n\r\n        // n2.el \u5B58\u5728\uFF0C\u610F\u5473\u7740\u8BE5\u5143\u7D20\u4E4B\u524D\u5DF2\u7ECF patch \u8FC7(\u53EF\u4EE5\u7406\u89E3\u4E3A\u5DF2\u7ECF\u6302\u8F7D\u8FC7)\r\n        if (n2.el) {\r\n          // \u9700\u8981\u79FB\u52A8\u5728\u8FDB\u53BB\r\n          if (move) {\r\n            // \u5F53 j \u4E0D\u5728\u6700\u957F\u9012\u589E\u5B50\u5E8F\u5217\u4E2D\u65F6\u8FDB\u884C\u79FB\u52A8\uFF0C\u5728\u5219\u4E0D\u9700\u8981\u79FB\u52A8\r\n            if (!sequenctSet.has(j)) {\r\n              // \u4F9D\u6B21\u8FDB\u884C\u5012\u5E8F\u63D2\u5165\uFF0C\u4FDD\u8BC1\u987A\u5E8F\r\n              hostInsert(n2.el, container, anchor)\r\n            }\r\n          }\r\n        } else {\r\n          // \u8BE5\u5143\u7D20\u662F\u4E2A\u65B0\u5143\u7D20\r\n          patch(null, n2, container, anchor)\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * \u66F4\u65B0\u8282\u70B9\u65F6\u7528\u5230\u7684\u51FD\u6570\r\n   * @param n1 \u65E7\u8282\u70B9\r\n   * @param n2 \u65B0\u8282\u70B9\r\n   */\r\n  const patchElement = (n1, n2) => {\r\n    /**\r\n     * 1. \u590D\u7528 dom \u5143\u7D20\r\n     * 2. \u66F4\u65B0 props\r\n     * 3. \u66F4\u65B0 children\r\n     */\r\n\r\n    // \u590D\u7528 dom \u5143\u7D20\uFF0C\u6BCF\u6B21\u8FDB\u6765\u90FD\u5C06\u4E0A\u4E00\u6B21\u7684 el \uFF0C\u4FDD\u5B58\u5230\u6700\u8FD1\u7684\u8282\u70B9\u4E0A\uFF0C\u4ECE\u800C\u5B9E\u73B0\u590D\u7528\r\n    const el = (n2.el = n1.el)\r\n\r\n    // \u66F4\u65B0\r\n    const oldProps = n1.props\r\n    const newProps = n2.props\r\n    patchProps(el, oldProps, newProps)\r\n\r\n    // \u66F4\u65B0 children\r\n    patchChildren(n1, n2)\r\n  }\r\n\r\n  /**\r\n   * \u66F4\u65B0\u3001\u6302\u8F7D \u90FD\u7528\u8FD9\u4E2A\u51FD\u6570\r\n   * @param n1 \u8001\u8282\u70B9\uFF0C\u4E4B\u524D\u7684\uFF0C\u5982\u679C\u6709\uFF0C\u8868\u793A\u8981\u8DDF n2 \u505A diff\uFF0C\u66F4\u65B0\uFF0C\u5982\u679C\u6CA1\u6709\uFF0C\u8868\u793A\u76F4\u63A5\u6302\u8F7D n2\r\n   * @param n2 \u65B0\u8282\u70B9\r\n   * @param container \u6302\u8F7D\u5230\u7684\u5BB9\u5668\r\n   */\r\n  const patch = (n1, n2, container, anchor = null) => {\r\n    if (n1 === n2) {\r\n      // \u5982\u679C\u662F\u540C\u4E00\u4E2A\u865A\u62DF\u8282\u70B9\uFF0C\u5219\u5565\u90FD\u4E0D\u5E72\r\n      return\r\n    }\r\n\r\n    /**\u6709\u51E0\u79CD\u60C5\u51B5\u9700\u8981\u89E6\u53D1\u7279\u6B8A\u7684\u66F4\u65B0\r\n     * 1. \u8282\u70B9\u7684\u7C7B\u578B\u53D1\u751F\u6539\u53D8  AS: div ==> p\r\n     * 2. \u8282\u70B9\u7684 props \u4E2D\u7684 key \u53D1\u751F\u6539\u53D8\uFF0C\u8FD9\u79CD\u60C5\u51B5\u4E00\u822C\u53D1\u751F\u5728 v-for \u4E2D\u7684 key \u503C\uFF0C\u540C\u65F6\u7528\u6237\u4E5F\u53EF\u4EE5\u81EA\u5DF1\u5728\u8282\u70B9\u4E2D\u589E\u52A0 key\u3002 const vnode1 = h('div', { style: { color: 'red' }, key: 1 }, 'hello world')\r\n     */\r\n    if (n1 && !isSameVNodeType(n1, n2)) {\r\n      // \u6BD4\u5982\u8BF4: n1 = div | n2 = span \u3002\u6216\u8005 n1.key = 1 | n2.key = 2 \u90FD\u9700\u8981\u7279\u6B8A\u7684\u66F4\u65B0\r\n      // \u4E0D\u4E00\u6837\u5219\u5378\u8F7D n1 \uFF0C\u91CD\u65B0\u6302\u8F7D n2\r\n      unmount(n1)\r\n      // \u5C06 n1 \u8BBE\u7F6E\u4E3A null \u89E6\u53D1\u4E0B\u9762\u7684\u91CD\u65B0\u6302\u8F7D\r\n      n1 = null\r\n    }\r\n\r\n    /**\r\n     * \u6587\u672C\uFF0C\u5143\u7D20\uFF0C\u7EC4\u4EF6\r\n     */\r\n    const { shapeFlag, type, ref } = n2\r\n\r\n    switch (type) {\r\n      case Text:\r\n        processText(n1, n2, container, anchor)\r\n        break\r\n      default:\r\n        if (shapeFlag & ShapeFlags.ELEMENT) {\r\n          // \u5904\u7406 DOM \u5143\u7D20: div span p h1\r\n          processElement(n1, n2, container, anchor)\r\n        } else if (shapeFlag & ShapeFlags.COMPONENT) {\r\n          // \u7EC4\u4EF6\r\n          processComponent(n1, n2, container, anchor)\r\n        }\r\n    }\r\n\r\n    if (ref != null) {\r\n      setRef(ref, n2)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * \u5224\u65AD\u4E24\u4E2A\u7EC4\u4EF6\u662F\u5426\u76F8\u540C\uFF0C\u76F8\u540C\u5219\u66F4\u65B0\u7EC4\u4EF6\uFF0C\u4E0D\u540C\u5219\u4E0D\u66F4\u65B0\r\n   * @param n1\r\n   * @param n2\r\n   */\r\n  const updateComponent = (n1, n2) => {\r\n    const instance = (n2.component = n1.component)\r\n\r\n    /**\r\n     * \u9700\u8981\u66F4\u65B0: props \u6216\u8005 slots \u53D1\u751F\u53D8\u5316\r\n     * \u4E0D\u9700\u8981\u66F4\u65B0: \u6CA1\u6709\u53D1\u751F\u6539\u53D8\r\n     */\r\n\r\n    // \u9700\u8981\u66F4\u65B0\r\n    if (shouldUpdateComponent(n1, n2)) {\r\n      // \u5C06\u65B0\u7684\u8282\u70B9\u5B58\u50A8\u5230\u5B9E\u4F8B\u4E2D\uFF0C\u4F7F\u5F97\u53EF\u4EE5\u8BFB\u5230\u65B0\u7684 props\r\n      instance.next = n2\r\n\r\n      instance.update()\r\n    } else {\r\n      // \u6CA1\u6709\u53D1\u751F\u53D8\u5316\uFF0C\u4E0D\u9700\u8981\u66F4\u65B0\uFF0C\u4F46\u8981\u66F4\u65B0\u865A\u62DF\u8282\u70B9\u4E0E\u590D\u7528\u5143\u7D20\r\n      // \u590D\u7528\u5143\u7D20\r\n      n2.el = n1.el\r\n      // \u66F4\u65B0\u865A\u62DF\u8282\u70B9\r\n      instance.vnode = n2\r\n    }\r\n  }\r\n\r\n  /**\r\n   * \u5904\u7406\u7EC4\u4EF6\u7684\u6302\u8F7D\u548C\u66F4\u65B0\r\n   * @param n1\r\n   * @param n2\r\n   * @param container\r\n   * @param anchor\r\n   */\r\n  const processComponent = (n1, n2, container, anchor) => {\r\n    if (n1 == null) {\r\n      // \u6302\u8F7D\u4E0E\u66F4\u65B0\uFF0C\u81EA\u8EAB\u4E2D\u7684\u5C5E\u6027\u53D1\u751F\u53D8\u5316\r\n      mountComponent(n2, container, anchor)\r\n    } else {\r\n      // \u7236\u7EC4\u4EF6\u4F20\u9012\u7684\u5C5E\u6027\u53D1\u751F\u53D8\u5316\u4ECE\u800C\u8FDB\u884C\u66F4\u65B0\r\n      updateComponent(n1, n2)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * \u66F4\u65B0\u7EC4\u4EF6\r\n   * @param instance\r\n   * @param nextVnode\r\n   */\r\n  const updateComponentPreRender = (instance, nextVnode) => {\r\n    /**\r\n     * \u590D\u7528\u7EC4\u4EF6\u5B9E\u4F8B\r\n     * \u66F4\u65B0 props\r\n     * \u66F4\u65B0 slots\r\n     */\r\n\r\n    // \u66F4\u65B0\u865A\u62DF\u8282\u70B9\r\n    instance.vnode = nextVnode\r\n    instance.next = null\r\n\r\n    // \u66F4\u65B0\u7EC4\u4EF6\u7684\u5C5E\u6027\r\n    updateProps(instance, nextVnode)\r\n\r\n    // \u66F4\u65B0\u7EC4\u4EF6\u7684\u63D2\u69FD\r\n    updateSlots(instance, nextVnode)\r\n  }\r\n\r\n  /**\r\n   * \u6302\u8F7D\u7EC4\u4EF6\u5230\u9875\u9762\u4E2D\r\n   *  1. \u5904\u7406\u6302\u8F7D\u4E0E\u66F4\u65B0\r\n   *  2. \u5C06\u7EC4\u4EF6\u5176\u8F6C\u6362\u4E3A\u54CD\u5E94\u5F0F\r\n   *\r\n   * @param instance\r\n   * @param container\r\n   * @param anchor\r\n   */\r\n  const setupRenderEffect = (instance, container, anchor) => {\r\n    const componentUpdateFn = () => {\r\n      /**\r\n       * \u533A\u5206\u6302\u8F7D\u548C\u66F4\u65B0\r\n       */\r\n      if (!instance.isMounted) {\r\n        // \u5B9E\u4F8B\u6302\u8F7D\u7684\u5904\u7406\u903B\u8F91\r\n\r\n        // \u62FF\u5230 vnode \u7684\u865A\u62DF\u8282\u70B9\r\n        const { vnode, render } = instance\r\n\r\n        // \u751F\u547D\u5468\u671F\u6302\u8F7D\u524D\r\n        triggerHooks(instance, LifeCycleHooks.BEFORE_MOUNT)\r\n\r\n        // \u5C06\u5B50\u6811\u7684 this \u6307\u5411 setupState \u4ECE\u800C\u80FD\u591F\u4F7F\u7528 setupState \u8FD4\u56DE\u7684\u72B6\u6001\r\n        const subTree = renderComponentRoot(instance)\r\n\r\n        // \u5C06 subTree \u6302\u8F7D\u5230\u9875\u9762\u4E2D\r\n        patch(null, subTree, container, anchor)\r\n\r\n        // \u5171\u4EAB\u771F\u5B9E DOM \u5143\u7D20\uFF0C\u7EC4\u4EF6\u7684 el \u4F1A\u6307\u5411 subTree \u7684 el\r\n        vnode.el = subTree.el\r\n\r\n        // \u4FDD\u5B58\u5B50\u6811\r\n        instance.subTree = subTree\r\n\r\n        // \u5C06\u6302\u8F7D\u72B6\u6001\u66F4\u65B0\r\n        instance.isMounted = true\r\n\r\n        // \u751F\u547D\u5468\u671F\u6302\u8F7D\u5B8C\r\n        triggerHooks(instance, LifeCycleHooks.MOUNTED)\r\n      } else {\r\n        // \u66F4\u65B0\u7684\u903B\u8F91\r\n        let { vnode, next } = instance\r\n\r\n        if (next) {\r\n          // \u5F53\u7236\u7EC4\u4EF6\u4F20\u9012\u7684\u5C5E\u6027\u53D1\u751F\u53D8\u5316\u65F6\uFF0Cnext \u5C31\u4F1A\u5B58\u5728\r\n          updateComponentPreRender(instance, next)\r\n        } else {\r\n          // \u5982\u679C\u6CA1\u6709\uFF0C\u610F\u5473\u7740\u6CA1\u6709\u5B50\u7EC4\u4EF6\uFF0C\u5C31\u7528\u4E4B\u524D\u7684\r\n          // next \u53EA\u6709\u5F53\u5B50\u7EC4\u4EF6\u53D1\u751F\u66F4\u65B0\u65F6\u624D\u6709\r\n          next = vnode\r\n        }\r\n\r\n        // \u751F\u547D\u5468\u671F\u66F4\u65B0\u524D\r\n        triggerHooks(instance, LifeCycleHooks.BEFORE_UPDATE)\r\n\r\n        const prevSubTree = instance.subTree\r\n\r\n        // \u5C06\u5B50\u6811\u7684 this \u6307\u5411 setupState \u4ECE\u800C\u80FD\u591F\u4F7F\u7528 setupState \u8FD4\u56DE\u7684\u72B6\u6001\r\n        const subTree = renderComponentRoot(instance)\r\n\r\n        // \u5C06 subTree \u6302\u8F7D\u5230\u9875\u9762\u4E2D\r\n        patch(prevSubTree, subTree, container, anchor)\r\n\r\n        // \u5171\u4EAB\u771F\u5B9E DOM \u5143\u7D20\uFF0C\u7EC4\u4EF6\u7684 el \u4F1A\u6307\u5411 subTree \u7684 el\r\n        next.el = subTree.el\r\n\r\n        // \u4FDD\u5B58\u6700\u65B0\u7684 subTree\r\n        instance.subTree = subTree\r\n\r\n        // \u751F\u547D\u5468\u671F\u66F4\u65B0\u5B8C\r\n        triggerHooks(instance, LifeCycleHooks.UPDATED)\r\n      }\r\n    }\r\n\r\n    /**\r\n     *\r\n     */\r\n    // \u521B\u5EFA effect\r\n    const effect = new ReactiveEffect(componentUpdateFn)\r\n    // \u62FF\u5230 effect \u4E2D\u7684 run \u65B9\u6CD5\r\n    const update = effect.run.bind(effect)\r\n\r\n    // \u5C06\u66F4\u65B0\u7684\u65B9\u6CD5\u5B58\u50A8\u5230\u5F53\u524D\u7684\u5B9E\u4F8B\u4E0A\r\n    instance.update = update\r\n\r\n    effect.scheduler = () => {\r\n      queueJob(update)\r\n    }\r\n\r\n    // \u542F\u52A8 effct\r\n    update()\r\n  }\r\n\r\n  const mountComponent = (vnode, container, anchor) => {\r\n    /**\r\n     * 1. \u521B\u5EFA\u7EC4\u4EF6\u5B9E\u4F8B\r\n     * 2. \u521D\u59CB\u5316\u7EC4\u4EF6\u7684\u72B6\u6001\r\n     * 3. \u5C06\u7EC4\u4EF6\u6302\u8F7D\u5230\u9875\u9762\u4E2D\r\n     */\r\n    // \u521B\u5EFA\u7EC4\u4EF6\u5B9E\u4F8B\r\n    const instance = createComponentInstance(vnode)\r\n\r\n    // \u4FDD\u5B58\u5B9E\u4F8B\uFF0C\u65B9\u4FBF\u590D\u7528\r\n    vnode.component = instance\r\n\r\n    // \u521D\u59CB\u5316\u7EC4\u4EF6\u7684\u72B6\u6001\r\n    setupComponent(instance)\r\n\r\n    // \u6302\u8F7D\u7EC4\u4EF6\r\n    setupRenderEffect(instance, container, anchor)\r\n  }\r\n\r\n  /**\r\n   * \u5904\u7406\u6587\u672C\u7684\u6302\u8F7D\u548C\u66F4\u65B0\r\n   * @param n1\r\n   * @param n2\r\n   * @param container\r\n   * @param anchor\r\n   */\r\n  const processText = (n1, n2, container, anchor) => {\r\n    if (n1 == null) {\r\n      // \u6302\u8F7D\r\n      const el = hostCreateText(n2.children)\r\n      // \u7ED9 vnode \u7ED1\u5B9A el\r\n      n2.el = el\r\n      // \u63D2\u5165\u5143\u7D20\u4E2D\r\n      hostInsert(el, container, anchor)\r\n    } else {\r\n      // \u590D\u7528\u8282\u70B9\r\n      n2.el = n1.el\r\n\r\n      // \u5982\u679C\u6587\u672C\u5185\u5BB9\u53D8\u4E86\u5C31\u66F4\u65B0\u6587\u672C\r\n      if (n1.children !== n2.children) {\r\n        hostSetText(n2.el, n2.children)\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * \u5904\u7406 DOM \u5143\u7D20\u7684\u7684\u6302\u8F7D\u4E0E\u66F4\u65B0\r\n   * @param n1\r\n   * @param n2\r\n   * @param container\r\n   * @param anchor\r\n   */\r\n  const processElement = (n1, n2, container, anchor) => {\r\n    if (n1 == null) {\r\n      // \u6302\u8F7D n2\r\n      mountElement(n2, container, anchor)\r\n    } else {\r\n      // \u66F4\u65B0 n2\r\n      patchElement(n1, n2)\r\n    }\r\n  }\r\n\r\n  const render = (vnode, container) => {\r\n    /**\r\n     * 1. \u6302\u8F7D\r\n     * 2. \u66F4\u65B0\r\n     * 3. \u5378\u8F7D\r\n     */\r\n\r\n    if (vnode == null) {\r\n      // \u5378\u8F7D\r\n      if (container._vnode) {\r\n        unmount(container._vnode)\r\n      }\r\n    } else {\r\n      // \u6302\u8F7D\u4E0E\u66F4\u65B0\r\n      patch(container._vnode || null, vnode, container)\r\n    }\r\n\r\n    // \u628A\u6700\u65B0\u7684 vnode \u4FDD\u5B58\u5230 container ,\u65B9\u4FBF\u66F4\u65B0\u548C\u5378\u8F7D\u65F6\u5019\u590D\u7528\r\n    container._vnode = vnode\r\n  }\r\n\r\n  return {\r\n    render,\r\n    createApp: createAppApi(render),\r\n  }\r\n}\r\n\r\n/**\r\n * \u6C42\u6700\u957F\u9012\u589E\u5B50\u5E8F\u5217\r\n * @param arr\r\n * @returns\r\n */\r\nfunction getSequence(arr) {\r\n  // \u6700\u957F\u9012\u589E\u5B50\u5E8F\u5217\u7684\u7ED3\u679C\r\n  const result = []\r\n\r\n  // \u8BB0\u5F55\u5E8F\u5217\u4E2D\u5143\u7D20\u7684\u524D\u9A71\u7D22\u5F15\r\n  const map = new Map()\r\n\r\n  // \u8BA1\u7B97\u51FA\u6700\u957F\u9012\u589E\u5B50\u5E8F\u5217\r\n  for (let i = 0; i < arr.length; i++) {\r\n    const item = arr[i]\r\n\r\n    // -1 \u4E0D\u9700\u8981\u8BA1\u7B97\r\n    if (item === -1 || item === undefined) {\r\n      continue\r\n    }\r\n\r\n    // \u5224\u65AD\u662F\u5426\u4E3A\u7B2C\u4E00\u4F4D\r\n    if (result.length === 0) {\r\n      result.push(i)\r\n      continue\r\n    }\r\n\r\n    // \u8BB0\u5F55\u6700\u957F\u9012\u589E\u5B50\u5E8F\u5217\u7684\u6700\u540E\u4E00\u9879\uFF0C\u65B9\u4FBF\u6BD4\u8F83\r\n    const lastIndex = result[result.length - 1]\r\n    const lastItem = arr[lastIndex]\r\n\r\n    // \u5982\u679C\u5F53\u9879\u5927\u4E8E\u4E0A\u4E00\u4E2A\uFF0C\u5219\u7EE7\u7EED\u6392\u5E8F\u5728\u540E\u9762\r\n    if (item > lastItem) {\r\n      result.push(i)\r\n      // \u5C06\u524D\u4E00\u4F4D\u5B58\u5165 map\r\n      map.set(i, lastIndex)\r\n      continue\r\n    }\r\n\r\n    // \u5F53\u524D\u9879\u5C0F\u4E8E\u4E0A\u4E00\u4E2A\uFF0C\u5219\u4F7F\u7528\u4E8C\u5206\u67E5\u6CD5\uFF0C\u627E\u51FA\u6700\u9002\u5408\u63D2\u5165\u7684\u4F4D\u7F6E\r\n    let left = 0\r\n    let right = result.length - 1\r\n\r\n    while (left < right) {\r\n      // \u4FDD\u5B58 result \u7684\u4E2D\u95F4\u7D22\u5F15 \u548C \u4E2D\u95F4\u9879\r\n      const mid = Math.floor((left + right) / 2)\r\n      const midItem = arr[result[mid]]\r\n\r\n      if (midItem < item) {\r\n        left = mid + 1\r\n      } else {\r\n        right = mid - 1\r\n      }\r\n    }\r\n\r\n    // \u627E\u51FA\u6700\u4F73\u63D2\u5165\u7684\u503C\r\n    if (arr[result[left]] > item) {\r\n      // \u5F53\u8BE5\u9879\u627E\u5230\u7B2C\u4E00\u9879\u5219\u4E0D\u9700\u8981\u8BB0\u5F55\u524D\u9A71\u8282\u70B9\r\n      if (left > 0) {\r\n        // \u8BB0\u5F55\u524D\u9A71\u8282\u70B9\r\n        map.set(i, result[left - 1])\r\n      }\r\n      // \u5C06\u6700\u957F\u9012\u589E\u5B50\u5E8F\u5217\u4E2D\u6700\u9002\u5408\u7684\u503C\u8FDB\u884C\u66FF\u6362\r\n      result[left] = i\r\n    }\r\n  }\r\n\r\n  // \u53CD\u5411\u8FFD\u6EAF\uFF0C\u4FDD\u8BC1\u987A\u5E8F\u6B63\u786E\r\n  let l = result.length\r\n  let last = result[l - 1]\r\n\r\n  while (l > 0) {\r\n    l--\r\n\r\n    // \u5C06\u5B50\u5E8F\u5217\u7684\u5185\u5BB9\u6839\u636E\u8BB0\u5F55\u7684\u524D\u9A71\u8282\u70B9\u4ECE\u540E\u5F80\u524D\u8FDB\u884C\u66FF\u6362\r\n    result[l] = last\r\n\r\n    // \u83B7\u53D6\u4E0B\u4E00\u4E2A\u8981\u5B58\u5165\u7684\u524D\u9A71\u7D22\u5F15\r\n    last = map.get(last)\r\n  }\r\n\r\n  return result\r\n}\r\n", "import { ref } from '@vue/reactivity'\r\nimport { getCurrentInstance } from './component'\r\n\r\nexport function useTemplateRef(key) {\r\n  const vm = getCurrentInstance()\r\n  const { refs } = vm\r\n\r\n  /**\r\n   * key = string\r\n   */\r\n  const elRef = ref(null)\r\n\r\n  Object.defineProperty(refs, key, {\r\n    get() {\r\n      // \u8BA9\u7528\u6237\u8BBF\u95EE refs[key] \u65F6\uFF0C\u628A elRef \u7ED9\u4ED6\r\n      return elRef.value\r\n    },\r\n    set(value) {\r\n      // \u62E6\u622A refs[key] = vnode.el\r\n      elRef.value = value\r\n    },\r\n  })\r\n\r\n  return elRef\r\n}\r\n", "/**\r\n * \u5C01\u88C5 DOM \u8282\u70B9\u64CD\u4F5C\u7684 API\r\n */\r\nexport const nodeOps = {\r\n  // \u63D2\u5165\u8282\u70B9\r\n  insert(el, parent, anchor) {\r\n    // insertBefore \u4E2D\u7B2C\u4E8C\u4E2A\u53C2\u6570\u4E3A\u89C9\u5F97\u63D2\u5165\u7684\u4F4D\u7F6E\uFF0C\u5982\u679C\u4E3A null \u5219\u63D2\u5165\u5728\u6700\u540E\u9762\r\n    parent.insertBefore(el, anchor || null)\r\n  },\r\n  // \u521B\u5EFA\u5143\u7D20\r\n  createElement(type) {\r\n    return document.createElement(type)\r\n  },\r\n  // \u79FB\u9664\u5143\u7D20\r\n  remove(el) {\r\n    const parentNode = el.parentNode\r\n    if (parentNode) {\r\n      parentNode.removeChild(el)\r\n    }\r\n  },\r\n\r\n  // \u8BBE\u7F6E\u5143\u7D20 text\r\n  setElementText(el, text) {\r\n    el.textContent = text\r\n  },\r\n  // \u521B\u5EFA\u6587\u672C\u8282\u70B9\r\n  createText(text) {\r\n    return document.createTextNode(text)\r\n  },\r\n  // \u8BBE\u7F6E node \u8282\u70B9\u7684 nodeValue\r\n  setText(node, text) {\r\n    return (node.nodeValue = text)\r\n  },\r\n  // \u83B7\u53D6\u5143\u7D20\u7684\u7684\u7236\u8282\u70B9\r\n  parentNode(el) {\r\n    return el.parentNode\r\n  },\r\n  // \u83B7\u53D6\u5143\u7D20\u7684\u4E0B\u4E00\u4E2A\u5144\u5F1F\u8282\u70B9\r\n  nextSibling(el) {\r\n    return el.nextSibling\r\n  },\r\n  // \u5143\u7D20\u9009\u62E9\u5668 dom \u67E5\u8BE2\r\n  querySelector(selector) {\r\n    return document.querySelector(selector)\r\n  },\r\n}\r\n", "export function patchClass(el, value) {\r\n  if (value == undefined) {\r\n    // null | undefined \u90A3\u5C31\u7406\u89E3\u4E3A\u8981\u79FB\u9664\r\n    el.removeAttribute('class')\r\n  } else {\r\n    el.className = value\r\n  }\r\n}\r\n", "export function patchStyle(el, preValue, nextValue) {\r\n  const style = el.style\r\n\r\n  // \u5982\u679C\u5B58\u5728\u65B0\u7684\u6837\u5F0F\u503C\uFF0C\u5219\u66F4\u65B0\u76F8\u5E94\u7684 style\r\n  if (nextValue) {\r\n    for (const key in nextValue) {\r\n      style[key] = nextValue[key]\r\n    }\r\n  }\r\n\r\n  // \u5982\u679C\u6709\u65E7\u503C\uFF0C\u5219\u9700\u8981\u6839\u636E\u5F53\u524D\u7684\u65B0\u503C\u5185\u662F\u5426\u5177\u6709\u539F\u5148\u76F8\u540C\u7684\u6837\u5F0F\u540D\u79F0\uFF0C\u5982\u679C\u6709\u5219\u4E0D\u9700\u8981\u7F6E\u7A7A\uFF0C\u6CA1\u6709\u5219\u9700\u8981\u7F6E\u7A7A\uFF0C\u4EE5\u4FBF\u6E05\u9664\u65E7\u7684\u6837\u5F0F\r\n  // old: { backgroundColor: 'red', color: 'blue'  } ==> new: { background: 'green'}\r\n  // \u6B64\u65F6\u5219\u9700\u8981\u5C06 color \u7F6E\u7A7A\uFF0C\u4F46 background \u4E0D\u7F6E\u7A7A\u76F4\u63A5\u66FF\u6362\u5373\u53EF\r\n  if (preValue) {\r\n    for (const key in preValue) {\r\n      if (nextValue?.[key] == null) {\r\n        style[key] = null\r\n      }\r\n    }\r\n  }\r\n}\r\n", "const veiKey = Symbol('_vei')\r\n\r\n/**\r\n * \u5BF9\u5143\u7D20\u7ED1\u5B9A\u76F8\u5E94\u7684\u4E8B\u4EF6\r\n *\r\n * const fn1 = ()=>{ console.log('\u66F4\u65B0\u524D')}\r\n * const fn2 = ()=>{ console.log('\u66F4\u65B0\u540E')}\r\n * \u8FD9\u6837\u91CD\u590D\u7684\u589E\u5220\u4E8B\u4EF6\u4F1A\u6BD4\u8F83\u6D6A\u8D39\u6027\u80FD\r\n *\r\n * click el.addEventListener('click', (e) => { fn1(e)})\r\n * \u901A\u8FC7\u66F4\u6362\u8981\u8C03\u7528\u7684\u51FD\u6570\u6765\u51CF\u5C11\u91CD\u590D\u89E3\u7ED1\u4E8B\u4EF6\r\n */\r\nexport function patchEvent(el, rawName, nextValue) {\r\n  const name = rawName.slice(2).toLowerCase()\r\n\r\n  const invokers = (el[veiKey] ??= {}) // \u4E3A\u7B80\u5199 el._vei = el._vei ?? {}\r\n\r\n  // \u539F\u5148\u662F\u5426\u5DF2\u7ECF\u6709\u7ED1\u5B9A\u8FC7\u7684\u4E8B\u4EF6\r\n  const exisitingInvoker = invokers[rawName]\r\n\r\n  if (nextValue) {\r\n    // \u5982\u679C\u539F\u5148\u6709\u5219\u76F4\u63A5\u5C06 exisitingInvoker = invokers[rawName] = invoker.value \u7684\u503C\u66FF\u6362\u4E3A\u65B0\u7684\u503C\uFF0C\u4ECE\u800C\u5B8C\u6210\u4E8B\u4EF6\u7684\u6362\u7ED1\r\n    if (exisitingInvoker) {\r\n      // \u4E0B\u4E00\u6B21\u8FDB\u6765\u5E94\u8BE5\u662F\u6709\u503C\u7684\r\n      exisitingInvoker.value = nextValue\r\n\r\n      return\r\n    }\r\n\r\n    // \u5982\u679C\u539F\u5148\u6CA1\u6709\uFF0C\u5219\u9700\u8981\u521B\u5EFA\u4E00\u4E2A invoker \uFF0C\u5B83\u662F\u4E00\u4E2A\u9700\u8981\u7ED1\u5B9A\u7684\u51FD\u6570\uFF0C\u4F46\u5176\u6267\u884C\u51FD\u6570\u53EF\u4EE5\u76F4\u63A5\u901A\u8FC7 invoker.value \u4FEE\u6539\uFF0C\u4ECE\u800C\u53EA\u9700\u8981\u6539\u53D8\u8BE5\u503C\uFF0C\u5373\u53EF\u6539\u53D8\u9700\u8981\u6267\u884C\u7684\u4E8B\u4EF6\u51FD\u6570\r\n    const invoker = createInvoker(nextValue)\r\n\r\n    // \u5C06 invoker \u653E\u5230 invokers = el._vei \u4E2D\r\n    invokers[rawName] = invoker\r\n\r\n    // \u7ED1\u5B9A\u4E8B\u4EF6\uFF0C\u4E8B\u4EF6\u7684\u5904\u7406\u51FD\u6570\u662F invoker.value \u53EF\u4EE5\u901A\u8FC7\u4FEE\u6539\u6765\u6539\u53D8\u6267\u884C\u7684\u51FD\u6570\r\n    el.addEventListener(name, invoker)\r\n  } else {\r\n    // \u5982\u679C\u65B0\u8282\u70B9\u4E2D\u6CA1\u6709\u4E8B\u4EF6\uFF0C\u800C\u8001\u8282\u70B9\u4E2D\u6709\uFF0C\u5219\u8981\u79FB\u9664\u4E8B\u4EF6\r\n    if (exisitingInvoker) {\r\n      el.removeEventListener(name, exisitingInvoker)\r\n      invokers[rawName] = undefined\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n *  \u521B\u5EFA\u4E00\u4E2A\u4E8B\u4EF6\u5904\u7406\u51FD\u6570\uFF0C\u5185\u90E8\u8C03\u7528 invoker.value\r\n *  \u5982\u679C\u9700\u8981\u66F4\u65B0\u4E8B\u4EF6\uFF0C\u5219\u76F4\u63A5\u4FEE\u6539 invoker.value \u4ECE\u800C\u5BF9\u4E8B\u4EF6\u8FDB\u884C\u6362\u7ED1\r\n *\r\n *\r\n * @param value \u63A5\u53D7\u7684\u51FD\u6570\r\n * @returns\r\n */\r\nfunction createInvoker(value) {\r\n  const invoker = e => {\r\n    invoker.value(e)\r\n  }\r\n  invoker.value = value\r\n  return invoker\r\n}\r\n", "/**\r\n * \u65B0\u589E\u6216\u5220\u9664\u5C5E\u6027\u540D\r\n * @param el\r\n * @param key\r\n * @param value\r\n */\r\nexport function patchAttr(el, key, value) {\r\n  if (value == undefined) {\r\n    // null | undefined \u90A3\u5C31\u7406\u89E3\u4E3A\u8981\u79FB\u9664\r\n\r\n    el.removeAttribute(key)\r\n  } else {\r\n    el.setAttribute(key, value)\r\n  }\r\n}\r\n", "import { isOn } from 'packages/shared/src/utils'\r\nimport { patchClass } from './modules/patchClass'\r\nimport { patchStyle } from './modules/patchStyle'\r\nimport { patchEvent } from './modules/event'\r\nimport { patchAttr } from './modules/patcchAttr'\r\n\r\n/**\r\n * \u66F4\u65B0\u5C5E\u6027\u7684\u51FD\u6570\r\n * key \u53EF\u80FD\u7684\u503C\r\n * 1. class \u6837\u5F0F\u540D\r\n * 2. style \u6837\u5F0F\r\n * 3. event \u4E8B\u4EF6\r\n * 4. attrs\r\n *\r\n * @param el\r\n * @param key\r\n * @param preValue\r\n * @param nextValue\r\n */\r\nexport function patchProp(el, key, preValue, nextValue) {\r\n  if (key === 'class') {\r\n    return patchClass(el, nextValue)\r\n  }\r\n  if (key === 'style') {\r\n    return patchStyle(el, preValue, nextValue)\r\n  }\r\n\r\n  // @click => onClick\r\n  if (isOn(key)) {\r\n    return patchEvent(el, key, nextValue)\r\n  }\r\n\r\n  patchAttr(el, key, nextValue)\r\n}\r\n", "export * from '@vue/runtime-core'\r\n\r\nimport { isString } from '@vue/shared'\r\nimport { nodeOps } from './nodeOps'\r\nimport { patchProp } from './patchProp'\r\nimport { createRenderer } from '@vue/runtime-core'\r\n\r\n// createRenderer(nodeOps)\r\n\r\nconst renderOptions = { patchProp, ...nodeOps }\r\n\r\nconst renderer = createRenderer(renderOptions)\r\n\r\nexport function render(vNode, container) {\r\n  renderer.render(vNode, container)\r\n}\r\n\r\nexport function createApp(rootComponent, rootProps) {\r\n  const app = renderer.createApp(rootComponent, rootProps)\r\n  const _mount = app.mount.bind(app)\r\n\r\n  // \u62E6\u622A app.mount \uFF0C\u4F7F\u5F97\u53EF\u4EE5\u901A\u8FC7\u4F20\u9012\u9009\u62E9\u5668\u53BB\u6302\u8F7D\uFF0C\u4E0D\u7136\u53EA\u80FD\u4E3A DOM \u5143\u7D20\u53BB\u6302\u8F7D\r\n  function mount(selector) {\r\n    let el = selector\r\n    if (isString(selector)) {\r\n      el = document.querySelector(selector)\r\n    }\r\n    _mount(el)\r\n  }\r\n  app.mount = mount\r\n\r\n  return app\r\n}\r\n\r\nexport { renderOptions }\r\n"],
  "mappings": "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",
  "names": ["link", "effect", "ReactiveFlags", "target", "cb", "effect", "ref", "render", "createApp", "LifeCycleHooks", "ref", "ref", "render", "effect"]
}
